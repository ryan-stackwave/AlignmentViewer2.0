(this["webpackJsonpalignment-viewer-2"]=this["webpackJsonpalignment-viewer-2"]||[]).push([[0],{29:function(e,t,n){e.exports=n(48)},34:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(25),i=n.n(a),s=(n(34),n(13)),l=n.n(s),c=n(8),u=n(1),h=n(2),d=n(5),p=n(4),m=n(6),f=(n(36),n(11));function g(e){var t=document.createElement("canvas").getContext("2d");t.fillStyle=e;var n=t.fillStyle;n=n.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,r){return"#"+t+t+n+n+r+r}));var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return{hex:n,rgb:{red:parseInt(r[1],16),green:parseInt(r[2],16),blue:parseInt(r[3],16)}}}var y=n(16),v=n.n(y),L=n(7),b=n.n(L),E=C("aa"),S=C("nt");function C(e){return Object.keys(b.a).reduce((function(t,n){if(-1!==n.indexOf(e+"StyClass_")){var r=n.split(e+"StyClass_")[1],o=b.a[e+"StyColorOrder_"+r].replace(/ /g,"").split(","),a=b.a[e+"StyColors_"+r].replace(/ /g,"").split(","),i=b.a[e+"StyDesc_"+r];t.push({commonName:r,description:i,className:b.a[n],backgroundAlpha:parseFloat(b.a[e+"StyBGAlpha_"+r]),colors:Object.fromEntries(o.map((function(e,t){return[o[t],a[t]]})))})}return t}),[])}var w=function(){function e(t,n,r,o){Object(u.a)(this,e),this.key=t,this.description=n,this.className=r,this.allColorSchemes=o}return Object(h.a)(e,null,[{key:"fromKey",value:function(t){return e.list.find((function(e){return e.key===t}))}}]),e}();w.AMINOACID=new w("aminoacid-alignment","Amino Acid Sequences",b.a.aaAlignTypeClass,E),w.NUCLEOTIDE=new w("nucleotide-alignment","Nucleotide Sequences",b.a.ntAlignTypeClass,S),w.list=[w.AMINOACID,w.NUCLEOTIDE];var k=function(){function e(t,n,r){Object(u.a)(this,e),this.key=t,this.description=n,this.className=r}return Object(h.a)(e,null,[{key:"fromKey",value:function(t){return e.list.find((function(e){return e.key===t}))}}]),e}();k.ALL=new k("all","All",b.a.styPosAllClass),k.QUERY=new k("query","Same as Query",b.a.styPosQueryClass),k.QUERY_DIFF=new k("query-diff","Different from Query",b.a.styPosQueryDiffClass),k.CONSENSUS=new k("consensus","Same as Consensus",b.a.styPosConsensusClass),k.CONSENSUS_DIFF=new k("consensus-diff","Different from Consensus",b.a.styPosConsensusDiffClass),k.list=[k.ALL,k.QUERY,k.QUERY_DIFF,k.CONSENSUS,k.CONSENSUS_DIFF];var O=function(){function e(t,n,r){Object(u.a)(this,e),this.key=t,this.description=n,this.className=r}return Object(h.a)(e,null,[{key:"fromKey",value:function(t){return e.list.find((function(e){return e.key===t}))}}]),e}();O.BOTH=new O("both","Style Background and Letters",""),O.LETTER_ONLY=new O("letter-only","Only Style Letters",b.a.transparentBackgroundClass),O.BACKGROUND_ONLY=new O("background-only","Only Style Background",b.a.transparentLetterClass),O.list=[O.BOTH,O.LETTER_ONLY,O.BACKGROUND_ONLY];var T,M=function(){function e(){Object(u.a)(this,e),this.alignmentType=void 0,this.colorScheme=void 0,this.positionsToStyle=void 0,this.residueDetail=void 0}return Object(h.a)(e,null,[{key:"fromAlignmentType",value:function(e){return e===w.AMINOACID?new A:new j}}]),e}(),A=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k.ALL,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O.BOTH;Object(u.a)(this,e),this.colorScheme=t,this.positionsToStyle=n,this.residueDetail=r,this.allColorSchemes=E,this.alignmentType=w.AMINOACID},j=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k.ALL,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O.BOTH;Object(u.a)(this,e),this.colorScheme=t,this.positionsToStyle=n,this.residueDetail=r,this.allColorSchemes=S,this.alignmentType=w.NUCLEOTIDE},N=(b.a.transparentLetterClass,b.a.transparentBackgroundClass,b.a.acePrefix);function x(e,t){var n=e.split("/");if(3!==n.length||"ace"!==n[0]||"mode"!==n[1])throw Error("ace mode name must be of the form '/ace/mode/MODENAME'");var r=e.split("/")[2];v.a.define("ace/mode/"+r+"_highlight_rules",(function(e,n,r){var o=e("../lib/oop"),a=e("./text_highlight_rules").TextHighlightRules,i=function(){for(var e={},n=function(n){var r=0===n?"start":"pos"+n,o=n===t.getMaxSequenceLength()-1?"start":"pos"+(n+1);e[r]=[{token:function(e){return function(e,t,n){return e+(t?"."+b.a.preAceConsensusClass:"")+(n?"."+b.a.preAceQueryClass:"")}(e,e===t.getConsensus()[n].letter,e===t.getTargetSequence().sequence[n])},regex:".",next:o}]},r=0;r<t.getMaxSequenceLength();r++)n(r);this.$rules=e};o.inherits(i,a),n.AlignmentHighlightRules=i})),v.a.define("ace/mode/"+r,(function(e,t,n){var o=e("../lib/oop"),a=e("../mode/text").Mode,i=e("../tokenizer").Tokenizer,s=e("ace/mode/"+r+"_highlight_rules").AlignmentHighlightRules,l=function(){this.$tokenizer=new i((new s).getRules())};o.inherits(l,a),function(){}.call(l.prototype),t.Mode=l}))}!function(e){e[e.hamming=0]="hamming"}(T||(T={}));var _=function(){function e(t,n,r,o){Object(u.a)(this,e),this.key=t,this.description=n,this.isTargetSequenceDependent=r,this.distanceFn=o}return Object(h.a)(e,null,[{key:"fromKey",value:function(t){return e.list.find((function(e){return e.key===t}))}}]),e}();_.INPUT=new _("as-input","As input",!1),_.HAMMING_DIST_TARGET=new _("hamming-dist-to-target","Hamming distance to target sequence",!0,T.hamming),_.list=[_.INPUT,_.HAMMING_DIST_TARGET];var q,D=function(){function e(t,n){var r=this;Object(u.a)(this,e),this.uuid=void 0,this.aceEditorMode=void 0,this.name=void 0,this.sequences=void 0,this.targetSequence=void 0,this.positionalLetterCounts=new Map,this.globalAlphaLetterCounts={},this.allAlphaLettersSorted=void 0,this.consensus=[],this.uuid=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(parseInt(e)^window.crypto.getRandomValues(new Uint8Array(1))[0]&15>>parseInt(e)/4).toString(16)})),this.name=t,this.sequences=new Map,this.sequences.set(_.INPUT,n),this.targetSequence=n[0];for(var o=new Date,a={},i=0;i<n.length;i++)for(var s=n[i].sequence,l=0;l<s.length;l++){var c=s[l].toUpperCase(),h=!!c.match(/[a-z]/i),d=l;a[c]=1;var p=this.positionalLetterCounts.get(d);p||(p={},this.positionalLetterCounts.set(d,p)),c in p===!1&&(p[c]=0),p[c]+=1,h&&(c in this.globalAlphaLetterCounts===!1&&(this.globalAlphaLetterCounts[c]=0),this.globalAlphaLetterCounts[c]+=1)}this.allAlphaLettersSorted=Object.keys(a).sort().reduce((function(e,t){return t.match(/[a-z]/i)&&e.push(t),e}),[]),this.consensus=Array.from(this.positionalLetterCounts).map((function(e){var t=Object(f.a)(e,2),n=t[0],o=t[1],a=r.allAlphaLettersSorted.reduce((function(e,t){return e in o===!1||o[e]<o[t]?t:e}));return{position:n,letter:a,occurrences:o[a]}})),console.log("done parsing alignment. took "+((new Date).getTime()-o.getTime())+"ms")}return Object(h.a)(e,null,[{key:"fromFileContents",value:function(t,n){for(var r=n.split(">"),o=[],a=0;a<r.length;a++){var i=r[a].split(/\r?\n/);if(i.length>1){var s={id:i[0],sequence:i.slice(1).join("")};o.push(s)}}return new e(t,o)}},{key:"getSequenceDistance",value:function(e,t,n){var r=e.sequence.length<t.sequence.length?e.sequence.length:t.sequence.length,o=0;if(n===T.hamming){for(var a=0;a<r;a++)e.sequence[a]!==t.sequence[a]&&(o+=1);return o}throw Error("Unable to determine sequence distance with distance function "+n)}},{key:"normalizeLetterCounts",value:function(e,t){var n=Object.keys(e).reduce((function(n,r){return t&&!t.includes(r)||(n+=e[r]),n}),0);return Object.keys(e).reduce((function(r,o){return t&&!t.includes(o)||(r[o]=e[o]/n),r}),{})}}]),Object(h.a)(e,[{key:"getUUID",value:function(){return this.uuid}},{key:"getName",value:function(){return this.name}},{key:"getAceEditorMode",value:function(){return this.aceEditorMode||(this.aceEditorMode="ace/mode/"+this.uuid,x(this.aceEditorMode,this)),this.aceEditorMode}},{key:"getConsensus",value:function(){return this.consensus}},{key:"getGapsPerColumn",value:function(){return Array.from(this.positionalLetterCounts).map((function(e){var t=Object(f.a)(e,2),n=(t[0],t[1]);return isNaN(n["-"])?0:n["-"]}))}},{key:"getGlobalAlphaLetterCounts",value:function(t,n){return t?e.normalizeLetterCounts(this.globalAlphaLetterCounts,n):this.globalAlphaLetterCounts}},{key:"getMaxSequenceLength",value:function(){return this.getSequences().reduce((function(e,t){return t.sequence.length>e&&(e=t.sequence.length),e}),-1)}},{key:"getPositionalLetterCounts",value:function(t,n){return t?Array.from(this.positionalLetterCounts).reduce((function(t,r){var o=Object(f.a)(r,2),a=o[0],i=o[1];return t.set(a,e.normalizeLetterCounts(i,n)),t}),new Map):this.positionalLetterCounts}},{key:"getSequences",value:function(e,t){if(e=e||_.INPUT,t=t||!1,!this.sequences.has(e)||t)switch(e){case _.INPUT:break;case _.HAMMING_DIST_TARGET:this.sequences.set(e,this.sortByDistanceToTargetSequence(_.HAMMING_DIST_TARGET.distanceFn));break;default:throw Error('The sortBy option provided "'.concat(e,'" is not implemented'))}return this.sequences.get(e)}},{key:"getSortedAlphaLetters",value:function(){return this.allAlphaLettersSorted}},{key:"getTargetSequence",value:function(){return this.targetSequence}},{key:"setTargetSequence",value:function(e){var t=this;if(void 0===this.getSequences().find((function(t){return t===e})))throw Error("target sequence does not exist in alignment");this.targetSequence=e,this.sequences.forEach((function(e,n){t.getSequences(n,!0)}))}},{key:"sortByDistanceToTargetSequence",value:function(t){var n=this,r=this.getSequences();switch(t){case T.hamming:return r.map((function(e){return e})).sort((function(t,r){return e.getSequenceDistance(n.targetSequence,t,T.hamming)-e.getSequenceDistance(n.targetSequence,r,T.hamming)}));default:throw Error('The distFn option provided "'.concat(t,'" is not implemented'))}}}]),e}();n(37);!function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal",e[e.both=2]="both"}(q||(q={}));var P=function(){function e(){Object(u.a)(this,e),this._groupScrollpropsHM={},this._lastScrollerOffsets=new Map,this._blockNextHorizontalScrollEvent=new Map,this._blockNextVerticalScrollEvent=new Map}return Object(h.a)(e,[{key:"_setScrollerLastOffsets",value:function(e){}},{key:"_getAceMaxScrollWidth",value:function(e){return e.renderer.$getLongestLine()+2*e.renderer.$padding-e.renderer.$size.scrollerWidth}},{key:"_handleScrollEvent",value:function(e,t,n,r){var o=this;this._blockNextHorizontalScrollEvent.get(e)||(this._setScrollerLastOffsets(e),this._groupScrollpropsHM[t].scrollers.forEach((function(t){t!==e&&("renderer"in t?r===q.horizontal&&t.session.getScrollLeft()!==n?(o._blockNextHorizontalScrollEvent.set(t,!0),t.session.setScrollLeft(n)):r===q.vertical&&t.session.getScrollTop()!==n&&(o._blockNextVerticalScrollEvent.set(t,!0),t.session.setScrollTop(n)):r===q.horizontal&&t.scrollLeft!==n?(o._blockNextHorizontalScrollEvent.set(t,!0),t.scrollLeft=n):r===q.vertical&&t.scrollTop!==n&&(o._blockNextVerticalScrollEvent.set(t,!0),t.scrollTop=n))})));this._blockNextHorizontalScrollEvent.set(e,!1)}},{key:"setScrollerGroup",value:function(e,t){this._groupScrollpropsHM[e]={scrolltype:t,scrollers:this._groupScrollpropsHM[e]?this._groupScrollpropsHM[e].scrollers:[]}}},{key:"registerScroller",value:function(e,t,n){var r=this,o=this._groupScrollpropsHM[t];if(!o)throw new Error('Error: attempt to register scroll sync on unknown group "'.concat(t,'"\n                    please register group first with setScrollerGroup'));if(o.scrollers.includes(e)){if(n)return;throw new Error('Error: attempt to re-add scroller to group "'.concat(t,'"'))}o.scrollers.push(e),this._setScrollerLastOffsets(e),"renderer"in e?(o.scrolltype!==q.both&&o.scrolltype!==q.horizontal||e.session.on("changeScrollLeft",(function(n){r._handleScrollEvent(e,t,Math.round(e.session.getScrollLeft()),q.horizontal)})),o.scrolltype!==q.both&&o.scrolltype!==q.vertical||e.session.on("changeScrollTop",(function(n){r._handleScrollEvent(e,t,Math.round(e.session.getScrollTop()),q.vertical)}))):e.onscroll=function(n){var a,i=n.target.scrollLeft!==(null===(a=r._lastScrollerOffsets.get(e))||void 0===a?void 0:a.lastLeft)?q.horizontal:q.vertical;o.scrolltype!==q.both&&o.scrolltype!==i||r._handleScrollEvent(e,t,n.target.scrollLeft,i)}}}],[{key:"getInstance",value:function(){return this.singleton||(this.singleton=new e),this.singleton}}]),e}();P.singleton=void 0;var z,R=function(){function e(){Object(u.a)(this,e),this.letterToGlyphHM={A:e.A,B:e.B,C:e.C,D:e.D,E:e.E,F:e.F,G:e.G,H:e.H,I:e.I,J:e.J,K:e.K,L:e.L,M:e.M,N:e.N,O:e.O,P:e.P,Q:e.Q,R:e.R,S:e.S,T:e.T,U:e.U,V:e.V,W:e.W,X:e.X,Y:e.Y,Z:e.Z}}return Object(h.a)(e,null,[{key:"glyphFromChar",value:function(t){return e.singleton||(e.singleton=new e),e.singleton.letterToGlyphHM[t]}}]),e}();R.singleton=void 0,R.A=function(e){return o.a.createElement("g",{key:e.key+"_g"},o.a.createElement("path",Object.assign({},e,{d:"M 0 100 L 33 0 L 66 0 L 100 100 L 75 100 L 66 75 L 33 75 L 25 100 L 0 100"})),o.a.createElement("path",{key:e.key+"_p2",transform:e.transform,fill:"#ffffff",d:"M 41 55 L 50 25 L 58 55 L 41 55"}))},R.B=function(e){return o.a.createElement("g",{key:e.key+"_g"},o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 80 0 C 105 0 105 50 80 50 C 105 50 105 100 80 100 L 00 100 L 0 0"})),o.a.createElement("path",{key:e.key+"_p2",transform:e.transform,d:"M 20 15 L 70 15 C 80 15 80 35 70 35 L 20 35 L 20 15",fill:"#ffffff"}),o.a.createElement("path",{key:e.key+"_p3",transform:e.transform,d:"M 20 65 L 70 65 C 80 65 80 85 70 85 L 20 85 L 20 65",fill:"#ffffff"}))},R.C=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 100 28 C 100 -13 0 -13 0 50 C 0 113 100 113 100 72 L 75 72 C 75 90 30 90 30 50 C 30 10 75 10 75 28 L 100 28"}))},R.D=function(e){return o.a.createElement("g",{key:e.key+"_g"},o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 60 0 C 110 0 110 100 60 100 L 0 100 L 0 0"})),o.a.createElement("path",{key:e.key+"_p2",transform:e.transform,fill:"#ffffff",d:"M 20 15 L 40 15 C 85 15 85 85 40 85 L 20 85 L 20 15"}))},R.E=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 100 0 L 100 20 L 20 20 L 20 40 L 90 40 L 90 60 L 20 60 L 20 80 L 100 80 L 100 100 L 0 100 L 0 0"}))},R.F=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 100 0 L 100 20 L 20 20 L 20 40 L 80 40 L 80 60 L 20 60 L 20 100 L 0 100 L 0 0"}))},R.G=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 100 28 C 100 -13 0 -13 0 50 C 0 113 100 113 100 72 L 100 48 L 55 48 L 55 72 L 75 72 C 75 90 30 90 30 50 C 30 10 75 5 75 28 L 100 28"}))},R.H=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 20 40 L 80 40 L 80 0 L 100 0 L 100 100 L 80 100 L 80 60 L 20 60 L 20 100 L 0 100 L 0 0"}))},R.I=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 40 0 L 60 0 L 60 100 L 40 100 L 40 0"}))},R.J=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 60 C 0 111 100 111 100 60 L 100 0 L 75 0 L 75 60 C 80 90 20 90 25 60"}))},R.K=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 20 40 L 75 0 L 100 0 L 50 50 L 100 100 L 75 100 L 30 65 L 20 75 L 20 100 L 0 100 L 0 0"}))},R.L=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 0 100 L 100 100 L 100 80 L 20 80 L 20 0 L 0 0"}))},R.M=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 50 35 L 80 0 L 100 0 L 100 100 L 80 100 L 80 30 L 50 65 L 20 30 L 20 100 L 0 100 L 0 0"}))},R.N=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 100 L 0 0 L 20 0 L 80 75 L 80 0 L 100 0 L 100 100 L 80 100 L 20 25 L 20 100 L 0 100"}))},R.O=function(e){return o.a.createElement("g",{key:e.key+"_g"},o.a.createElement("circle",Object.assign({cx:"50",cy:"50",r:"50"},e)),o.a.createElement("circle",{key:e.key+"_c2",transform:e.transform,cx:"50",cy:"50",r:"32",fill:"#ffffff"}))},R.P=function(e){return o.a.createElement("g",{key:e.key+"_g"},o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 80 0 C 105 0 105 50 80 50 L 20 50 L 20 100 L 0 100 L 0 0"})),o.a.createElement("path",{key:e.key+"_p2",transform:e.transform,fill:"#ffffff",d:"M 20 15 L 70 15 C 80 15 80 35 70 35 L 20 35 L 20 15"}))},R.Q=function(e){return o.a.createElement("g",{key:e.key+"_g"},o.a.createElement("circle",Object.assign({cx:"50",cy:"50",r:"50"},Object(c.a)({},e,{key:e.key+"_c1"}))),o.a.createElement("circle",{key:e.key+"_c2",transform:e.transform,cx:"50",cy:"50",r:"32",fill:"#ffffff"}),o.a.createElement("path",Object.assign({d:"M 85 100 L 55 70 L 70 55 L 100 85 L 85 100"},e)))},R.R=function(e){return o.a.createElement("g",{key:e.key+"_g"},o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 80 0 C 105 0 105 50 80 50 C 100 50 100 70 100 70 L 100 100 L 80 100 L 80 80 C 80 80 80 60 50 60 L 20 60 L 20 100 L 0 100 L 0 0"})),o.a.createElement("path",{key:e.key+"_p2",transform:e.transform,fill:"#ffffff",d:"M 20 15 L 70 15 C 80 15 80 35 70 35 L 20 35 L 20 15"}))},R.S=function(e){return e.stroke||(e.stroke=e.fill),e.strokeOpacity||(e.strokeOpacity=e.fillOpacity),o.a.createElement("path",Object.assign({fill:"#ffffff"},e,{strokeWidth:"18",d:"M92 26 A43 20 0 1 0 43 46 A42 23 0 1 1 9 68"}))},R.T=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 0 20 L 35 20 L 35 100 L 65 100 L 65 20 L 100 20 L 100 0 L 0 0"}))},R.U=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 0 60 C 0 111 100 111 100 60 L 100 0 L 75 0 L 75 60 C 80 90 20 90 25 60 L 25 0 L 0 0"}))},R.V=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 50 80 L 80 0 L 100 0 L 60 100 L 40 100 L 0 0"}))},R.W=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 30 70 L 50 30 L 70 70 L 80 0 L 100 0 L 90 100 L 70 100 L 50 65 L 30 100 L 10 100 L 0 0"}))},R.X=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 50 40 L 80 0 L 100 0 L 70 50 L 100 100 L 80 100 L 50 60 L 20 100 L 0 100 L 30 50 L 0 0"}))},R.Y=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 50 45 L 80 0 L 100 0 L 60 60 L 60 100 L 40 100 L 40 60 L 0 0"}))},R.Z=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 100 0 L 100 20 L 35 80 L 100 80 L 100 100 L 0 100 L 0 80 L 65 20 L 0 20 L 0 0"}))},function(e){e.LETTERS="letter stack",e.BARS="bar plot"}(z||(z={}));var I=function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).scrollerDiv=void 0,n.loaded=!1,n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"divLoaded",value:function(e){e&&!this.scrollerDiv&&(this.scrollerDiv=e,this.props.logoLoaded&&this.props.logoLoaded(this.scrollerDiv))}},{key:"shouldComponentUpdate",value:function(e){return!1===this.loaded||this.props.logoType!==e.logoType||this.props.glyphWidth!==e.glyphWidth||this.props.alignment!==e.alignment}},{key:"render",value:function(){var e=this;if(!this.props.alignment||!this.props.glyphWidth)return null;var t=this.props.alignment.getPositionalLetterCounts(),n=this.props.alignment.getSortedAlphaLetters(),r=[];t.forEach((function(e,t){var o=Object.keys(e).reduce((function(t,n){return t+=e[n]}),0),a=n.map((function(t){var n=0;return t in e&&(n=e[t]/o),n}));r.push(a)}));var a=n.map((function(e){return{letter:e,classNames:N+e}})),i=r.map((function(e,t){return e.map((function(e,t){return{frequency:e,letter:a[t]}})).filter((function(e){return 0!==e.frequency})).sort((function(e,t){return e.frequency>t.frequency?1:-1}))})),s=r.length*this.props.glyphWidth;this.loaded=!0;return o.a.createElement("div",{id:this.props.id,ref:function(t){return e.divLoaded(t)}},o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 ".concat(i.length," 100"),style:{width:s,height:100},xmlns:"http://www.w3.org/2000/svg"},i.map((function(t,n){return o.a.createElement("g",{transform:"translate(".concat(n,",0)"),key:"p_"+n},function(t){var n=100,r=2/i.length;return t.map((function(t,a){return n-=100*t.frequency,e.props.logoType===z.BARS?o.a.createElement("rect",{width:"100",height:"100",transform:"translate(0, ".concat(n,") scale(").concat(r,",").concat(t.frequency,")"),className:t.letter.classNames,key:"idxrect_".concat(a)}):R.glyphFromChar(t.letter.letter)({className:t.letter.classNames,transform:"translate(0, ".concat(n,") scale(").concat(r,",").concat(t.frequency,")"),key:"idxglyph_".concat(a)})}))}(t))}))))}}]),t}(o.a.Component),H=n(28),B=n(10),W=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).scrollerDiv=void 0,n.state={isHovered:!1},n.handleSvgHover=n.handleSvgHover.bind(Object(B.a)(n)),n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"handleSvgHover",value:function(e){this.setState({isHovered:e})}},{key:"computeEntropy",value:function(e,t,n,r){return e.reduce((function(e,r){return r in t&&(e+=t[r]*Math.log(t[r]/n[r])),e}),0)}},{key:"createConservationCountGs",value:function(){var e=this,t=[],n=this.props.alignment.getSortedAlphaLetters(),r=this.props.alignment.getPositionalLetterCounts(!0,n),a=this.props.alignment.getGlobalAlphaLetterCounts(!0,n),i=Array.from(r).map((function(t){var r=Object(f.a)(t,2),o=(r[0],r[1]);return e.computeEntropy(n,o,a)})),s=Math.max.apply(Math,Object(H.a)(i));return i.map((function(e){return e/s*100})).forEach((function(e,n){t.push(o.a.createElement("g",{transform:"translate(".concat(n,",").concat(100-e,")"),key:n},o.a.createElement("rect",{width:.5,height:"".concat(e)})))})),t}},{key:"createGapCountGs",value:function(e){for(var t=[],n=this.props.alignment.getSequences().length,r=this.props.alignment.getGapsPerColumn(),a=0;a<e;a++){var i=r[a]/n*100;t.push(o.a.createElement("g",{transform:"translate(".concat(a+.5,",").concat(100-i,")"),key:a},o.a.createElement("rect",{width:.5,height:i})))}return t}},{key:"divLoaded",value:function(e){e&&!this.scrollerDiv&&(this.scrollerDiv=e,this.props.conservationPlotLoaded&&this.props.conservationPlotLoaded(this.scrollerDiv))}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this;if(!this.props.alignment||!this.props.characterWidth)return null;var t=this.props.alignment.getMaxSequenceLength(),n=this.props.characterWidth*t,r=this.state.isHovered?"conservation hovered":"conservation";return o.a.createElement("div",null,o.a.createElement("div",{style:{backgroundColor:"rgba(255,255,255,0.9)",border:"solid 1px black",position:"absolute",padding:"3px",top:0,right:0,color:"red",visibility:this.state.isHovered?"visible":"hidden",zIndex:1e3}},o.a.createElement("span",{style:{color:"#000000"}},"Entropy"),o.a.createElement("span",{style:{color:"#b7b7b7",paddingLeft:10}},"# Gaps")),o.a.createElement("div",{id:this.props.id,ref:function(t){return e.divLoaded(t)}},o.a.createElement("div",{className:"svg_container"},o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 ".concat(t," 100"),style:{width:n,height:100},className:r,xmlns:"http://www.w3.org/2000/svg",onMouseEnter:function(){return e.handleSvgHover(!0)},onMouseLeave:function(){return e.handleSvgHover(!1)}},o.a.createElement("g",{className:"gapCount"},this.createGapCountGs(t)),o.a.createElement("g",{className:"entropy"},this.createConservationCountGs())))))}}]),t}(o.a.Component),F=function(){function e(t,n,r){Object(u.a)(this,e),this.singleLetterCode=t,this.threeLetterCode=n,this.fullName=r,this.glyph=void 0,this.colors=void 0,this.singleLetterCode=t,this.threeLetterCode=n,this.fullName=r,this.glyph=R.glyphFromChar(t),this.colors=E.reduce((function(e,n){var r=Object.entries(n.colors).find((function(e){var n=Object(f.a)(e,2),r=n[0];n[1];return r===t})),o="#ffffff";r&&(o=r[1]);var a=g(o);return e[n.commonName]={hexString:a.hex,rgb:a.rgb,backgroundAlpha:n.backgroundAlpha},e}),{})}return Object(h.a)(e,null,[{key:"fromSingleLetterCode",value:function(t){return t in this.bySingleLetterCode?e.bySingleLetterCode[t]:e.UNKNOWN}},{key:"fromThreeLetterCode",value:function(t){return t in this.byThreeLetterCode?e.byThreeLetterCode[t]:e.UNKNOWN}}]),e}();F.canonicalAminoAcids=[new F("A","ALA","Alanine"),new F("R","ARG","Arginine"),new F("N","ASN","Asparagine"),new F("D","ASP","Aspartic Acid"),new F("C","CYS","Cysteine"),new F("Q","GLU","Glutamine"),new F("E","GLN","Glutamic Acid"),new F("G","GLY","Glycine"),new F("H","HIS","Histidine"),new F("I","ILE","Isoleucine"),new F("L","LEU","Leucine"),new F("K","LYS","Lysine"),new F("M","MET","Methionine"),new F("F","PHE","Phenylalanine"),new F("P","PRO","Proline"),new F("S","SER","Serine"),new F("T","THR","Threonine"),new F("W","TRP","Tryptophan"),new F("Y","TYR","Tyrosine"),new F("V","VAL","Valine"),new F("X","UKN","Unknown Amino Acid")],F.bySingleLetterCode=F.canonicalAminoAcids.reduce((function(e,t){return e[t.singleLetterCode]=t,e}),{}),F.byThreeLetterCode=F.canonicalAminoAcids.reduce((function(e,t){return e[t.threeLetterCode]=t,e}),{}),F.UNKNOWN=F.bySingleLetterCode.X;var U=function(){function e(t,n){Object(u.a)(this,e),this.singleLetterCode=t,this.fullName=n,this.glyph=void 0,this.colors=void 0,this.singleLetterCode=t,this.fullName=n,this.glyph=R.glyphFromChar(t),this.colors=S.reduce((function(e,n){var r=Object.entries(n.colors).find((function(e){var n=Object(f.a)(e,2),r=n[0];n[1];return r===t})),o="#ffffff";r&&(o=r[1]);var a=g(o);return e[n.commonName]={hexString:a.hex,rgb:a.rgb,backgroundAlpha:n.backgroundAlpha},e}),{})}return Object(h.a)(e,null,[{key:"fromSingleLetterCode",value:function(t){return t in this.bySingleLetterCode?e.bySingleLetterCode[t]:e.UNKNOWN}}]),e}();U.allNucleotides=[new U("A","Adenine"),new U("C","Cytosine"),new U("G","Guanine"),new U("T","Thymidine"),new U("U","Uracil"),new U("R","Purine"),new U("Y","Pyrimidine"),new U("X","Unknown Nucleotide")],U.bySingleLetterCode=U.allNucleotides.reduce((function(e,t){return e[t.singleLetterCode]=t,e}),{}),U.UNKNOWN=U.bySingleLetterCode.X;var G=n(3),Y=n(14),V=n(27),Q=Object(Y.PixiComponent)("AlignmentHighlighter",{create:function(e){return new G.Graphics},applyProps:function(e,t,n){var r=n.x,o=n.y,a=n.width,i=n.height,s=n.fillColor,l=n.fillAlpha;e.clear(),e.beginFill(s,l),e.drawRect(r,o,a,i),e.endFill()}}),K=function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(a)))).app=void 0,n.scaleX=1,n.scaleY=1,n.renderAlignmentHighlighter=function(e){return o.a.createElement(Q,Object(c.a)({fillColor:16711680,fillAlpha:.25},e))},n.onMouseEnter=function(e){document.body.style.overflow="hidden"},n.onMouseLeave=function(e){document.body.style.overflow="auto"},n.onWheel=function(e){},n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"sliderChanged",value:function(e,t){this.app&&this.app.stage.children.forEach((function(n){"x"===t?n.scale.x=e:n.scale.y=e}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.alignment,r=t.alignmentType,a=t.colorScheme,i=t.highlightRows,s=t.id,l=t.positionsToStyle,c=t.sortBy,u=t.stageResolution,h=t.viewportProps;if(!n)return null;var d=n.getSequences().length,p=n.getMaxSequenceLength();G.settings.SCALE_MODE=G.SCALE_MODES.NEAREST;var m=i?i[1]-i[0]:void 0;return o.a.createElement("div",{id:s,onWheel:this.onWheel,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},o.a.createElement(Y.Stage,{width:null===u||void 0===u?void 0:u.width,height:null===u||void 0===u?void 0:u.height,options:{transparent:!0}},o.a.createElement(Y.AppContext.Consumer,null,(function(t){return e.app=t,o.a.createElement(o.a.Fragment,null)})),o.a.createElement(Y.AppContext.Consumer,null,(function(t){return o.a.createElement($,Object.assign({app:t,numColumns:p,numRows:d,mouseDown:e.props.mouseDown},h),o.a.createElement(Z,{id:"tiled-alignment",alignment:n,alignmentType:r,sortBy:c,colorScheme:a,positionsToStyle:l}),m?o.a.createElement(o.a.Fragment,null,e.renderAlignmentHighlighter({x:0,y:e.props.highlightRows[0],width:p,height:m})):o.a.createElement(o.a.Fragment,null))}))))}}]),t}(o.a.Component);K.defaultProps={mouseDown:function(){},stageResolution:{width:485,height:650},viewportProps:{useDrag:!0,usePinch:!0,useWheel:!0,zoomPercent:0}};var X,Z=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(h.a)(t,[{key:"shouldComponentUpdate",value:function(e){return e.alignment!==this.props.alignment||e.colorScheme!==this.props.colorScheme||e.positionsToStyle!==this.props.positionsToStyle||e.sortBy!==this.props.sortBy}},{key:"render",value:function(){if(!this.props.alignment)return null;for(var e=this.props,t=e.alignment,n=e.alignmentType,r=e.colorScheme,a=e.positionsToStyle,i=e.sortBy,s=t.getSequences(i),l=t.getMaxSequenceLength(),c=s.length,u={fullWidth:l,fullHeight:c,targetTileWidth:Math.min(400,l),targetTileHeight:Math.min(400,c)},h=this.initializeTiledImages(u),d=0;d<h.numYTiles;d++)for(var p=0;p<h.numXTiles;p++){var m=this.generateCanvasForTile(p,d,u.targetTileWidth,u.targetTileHeight,h,s);h.tiles.push(m)}return o.a.createElement(o.a.Fragment,null,h.tiles.map((function(e){return o.a.createElement(Y.Sprite,{source:e.image,x:e.pixelX,y:e.pixelY,key:"".concat(e.tileX,"_\n                  ").concat(e.tileY,"_\n                  ").concat(r.commonName,"_\n                  ").concat(a.key,"_\n                  ").concat(n.key,"_\n                  ").concat(i.key,"_\n                  ").concat(t.getName())})})))}},{key:"colorCanvasWithSequence",value:function(e,t,n,r,o){for(var a=0,i=0;i<n.height;i++)for(var s=r[i+o.seqY],l=0;l<n.width;l++){var c=s.sequence[l+o.letterX],u=this.getCurrentMoleculeColors(c,l,o);e.data[a]=u.rgb.red,e.data[a+1]=u.rgb.green,e.data[a+2]=u.rgb.blue,e.data[a+3]=255,a+=4}t.putImageData(e,0,0)}},{key:"generateCanvasForTile",value:function(e,t,n,r,o,a){var i=document.createElement("canvas");i.height=t===o.numYTiles-1?o.lastTileHeight:r,i.width=e===o.numXTiles-1?o.lastTileWidth:n;var s={seqY:t*r,letterX:e*n},l=i.getContext("2d");null===l||void 0===l||l.fillRect(0,0,i.width,i.height);var c=null===l||void 0===l?void 0:l.getImageData(0,0,i.width,i.height);return c&&l&&this.colorCanvasWithSequence(c,l,i,a,s),{tileX:e,tileY:t,pixelX:s.letterX,pixelY:s.seqY,width:i.width,height:i.height,image:i}}},{key:"getCurrentMoleculeColors",value:function(e,t,n){var r=this.props,o=r.alignment,a=r.alignmentType,i=r.colorScheme,s=o.getConsensus(),l=o.getTargetSequence().sequence,c=a===w.AMINOACID?F:U,u=c.UNKNOWN;if(this.props.positionsToStyle===k.ALL)u=c.fromSingleLetterCode(e);else{var h=s[t+n.letterX].letter===e,d=l[t+n.letterX]===e;(this.props.positionsToStyle===k.CONSENSUS&&h||this.props.positionsToStyle===k.CONSENSUS_DIFF&&!h||this.props.positionsToStyle===k.QUERY&&d||this.props.positionsToStyle===k.QUERY_DIFF&&!d)&&(u=c.fromSingleLetterCode(e))}return u.colors[i.commonName]}},{key:"initializeTiledImages",value:function(e){var t=e.targetTileWidth,n=void 0===t?0:t,r=e.targetTileHeight,o=void 0===r?0:r,a=e.fullWidth,i=void 0===a?0:a,s=e.fullHeight,l=void 0===s?0:s;return{targetTileWidth:n,targetTileHeight:o,lastTileWidth:i%n!==0?i%n:n,lastTileHeight:l%o!==0?l%o:o,numXTiles:i%n!==0?Math.floor(i/n)+1:Math.floor(i/n),numYTiles:l%o!==0?Math.floor(l/o)+1:Math.floor(l/o),tiles:[]}}}]),t}(o.a.Component),$=Object(Y.PixiComponent)("PixiViewport",{create:function(e){var t=e.app,n=e.numColumns,r=e.numRows,o=e.useDrag,a=e.usePinch,i=e.useWheel,s=e.zoomPercent;t.renderer.backgroundColor=16777215;var l=new V.a({screenWidth:t.renderer.width,screenHeight:t.renderer.height,worldWidth:Math.max(n,t.renderer.width)+1,worldHeight:r,interaction:t.renderer.plugins.interaction}).decelerate().clamp({direction:"all"}).bounce({friction:.1,time:150,underflow:"center"}).clampZoom({maxHeight:t.renderer.height,maxWidth:t.renderer.width});return o&&(l=l.drag({direction:"all"})),a&&(l=l.pinch()),i&&(l=l.wheel()),s&&(l=l.zoomPercent(s)),l.on("clicked",(function(t){e.mouseDown&&e.mouseDown(t.world.x,t.world.y)})),X=l,l},applyProps:function(e,t,n){return t.zoomPercent!==n.zoomPercent&&n.zoomPercent&&(X=X.setZoom(n.zoomPercent,!1)),X}}),J=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).renderCanvasComponent=function(){var e=n.props,t=e.alignment,o=e.height,a=e.highlightRows,i=e.sortBy,s=e.style,l=e.width,c=n.state.zoomPercent;return r.createElement("div",{style:{opacity:.75}},r.createElement(K,{id:"alignment_canvas",alignment:t,alignmentType:s.alignmentType,positionsToStyle:s.positionsToStyle,colorScheme:s.colorScheme,sortBy:i,stageResolution:{width:l,height:o},highlightRows:a,viewportProps:{useDrag:!0,usePinch:!0,useWheel:!0,zoomPercent:c},mouseDown:n.onMouseDown}))},n.renderZoomControls=function(){return r.createElement("div",{style:{textAlign:"center",opacity:1}},r.createElement("button",{onClick:n.onZoomOut},"-"),r.createElement("button",{onClick:n.onZoomReset},"Reset"),r.createElement("button",{onClick:n.onZoomIn},"+"))},n.onMouseDown=function(e,t){var r=n.props.onClick;r&&r(e,t)},n.onZoomIn=function(){var e=n.state.zoomPercent;n.setState({zoomPercent:Math.min(8,e+.25)})},n.onZoomOut=function(){var e=n.state.zoomPercent;n.setState({zoomPercent:Math.max(.25,e-.25)})},n.onZoomReset=function(){n.setState({zoomPercent:1})},n.state={zoomPercent:1},n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props,t=e.alignHorizontal,n=(e.alignVertical,e.height),o=e.width;return r.createElement("div",{style:Object(c.a)({zIndex:1e5},"left"===t?{left:0}:{right:0},{top:0,bottom:0,height:n,position:"fixed",width:o})},this.renderCanvasComponent(),this.renderZoomControls())}}]),t}(r.Component);J.defaultProps={alignHorizontal:"right",alignVertical:"top",height:600,width:300};var ee=function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).editor=void 0,n.lastText=void 0,n.lastMode=void 0,n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"getText",value:function(){if(this.props.text)return this.props.text;throw Error("Internal error: 'text' attribute must be provided or subclasses must implement getText()")}},{key:"getEditorMode",value:function(){return this.props.editorMode}},{key:"_setupEditorAndEventListeners",value:function(e){this.editor=v.a.edit(e),this.editor.setShowPrintMargin(!1),this.editor.setReadOnly(!0),this.editor.setHighlightActiveLine(!1),this.editor.setHighlightGutterLine(!1),this.editor.setFontSize(this.props.fontSize+"px"),this.editor.renderer.setShowGutter(!1),this.editor.renderer.setPadding(0),this.editor.renderer.$cursorLayer.element.style.display="none"}},{key:"_addMouseEventListeners",value:function(){var e=this;if(!this.editor)throw Error("Editor must be defined before adding mouse listeners.");function t(e,t){var n=t.getDocumentPosition(),r=e.renderer.textToScreenCoordinates(n.row,n.column);return{mouseRow:n.row,mouseColumn:n.column,mousePageX:r.pageX,mousePageY:r.pageY}}return this.editor.on("mousemove",(function(n){e.props.mouseMove&&e.props.mouseMove(t(e.editor,n))})),this.editor.on("mousedown",(function(n){e.props.mouseDown&&e.props.mouseDown(t(e.editor,n))})),this.editor}},{key:"_setText",value:function(){if(!this.editor)throw Error("Editor must be defined to call setText()");if(!this.lastMode||this.lastMode!==this.getEditorMode()){var e=this.getEditorMode();this.editor.session.setMode(e),this.lastMode=e}if(!this.lastText||this.lastText!==this.getText()){this.editor.selectAll(),this.editor.removeLines();var t=this.getText();this.editor.insert(t),this.lastText=t}}},{key:"_initialLoad",value:function(e){e&&!this.editor&&(this._setupEditorAndEventListeners(e),this._addMouseEventListeners(),this._setText(),this.props.editorLoaded&&this.props.editorLoaded(this.editor))}},{key:"componentDidUpdate",value:function(e){if(!this.editor)throw Error("internal error - componentDidUpdate called before editor initialized");var t,n;this.props.fontSize+"px"!==this.editor.getFontSize()&&(null===(t=this.editor)||void 0===t||t.setFontSize(this.props.fontSize+"px"),this.props.characterSizeChanged&&(null===(n=this.editor)||void 0===n?void 0:n.renderer.characterWidth)&&this.props.characterSizeChanged(this.editor.renderer.characterWidth));this._setText()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:this.props.classNames,onMouseEnter:function(){e.props.mouseEnter&&e.props.mouseEnter()},onMouseLeave:function(){e.props.mouseLeave&&e.props.mouseLeave()}},o.a.createElement("div",{id:this.props.id,ref:function(t){return e._initialLoad(t)}}))}}]),t}(o.a.Component),te=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(h.a)(t,[{key:"getText",value:function(){return this.props.alignment.getSequences(this.props.sortBy).map((function(e){return e.sequence})).join("\n")}},{key:"getEditorMode",value:function(){return this.props.alignment.getAceEditorMode()}}]),t}(ee),ne=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(h.a)(t,[{key:"getText",value:function(){return this.props.alignment.getConsensus().map((function(e){return e.letter})).join("")}}]),t}(te),re=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(h.a)(t,[{key:"getText",value:function(){return this.props.alignment.getTargetSequence().sequence}}]),t}(te),oe=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(h.a)(t,[{key:"getText",value:function(){return t.generateTextualRuler(this.props.alignment.getMaxSequenceLength())}},{key:"getEditorMode",value:function(){}}],[{key:"generateTextualRuler",value:function(e){for(var t="",n=1;n<=e+1;n++){var r=n%10===0;if(t+=r?"|":!r&&n%5===0?":":".",r){var o=""+n,a=t.length-o.length-1;a<0||(t=t.substr(0,a)+o+"|")}}return t}}]),t}(ee),ae=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e)))._handleCharacterSizeChanged=function(e){n.state.aceCharacterWidth!==e&&n.setState({aceCharacterWidth:e})},n._aceEditorLoaded=function(e,t,r){var o=P.getInstance();r!==q.horizontal&&r!==q.both||o.registerScroller(t,"horizontal"),r!==q.vertical&&r!==q.both||o.registerScroller(t,"vertical"),n.setState({aceCharacterWidth:t.renderer.characterWidth,aceEditors:[t].concat(n.state.aceEditors)}),"ace-alignment"===e&&t.renderer.on("afterRender",(function(){setTimeout((function(){n.setState({alignmentEditorVisibleFirstRow:t.renderer.getFirstFullyVisibleRow(),alignmentEditorVisibleLastRow:t.renderer.getLastFullyVisibleRow()})}))}))},n.renderSequenceLogo=function(){return o.a.createElement("div",{className:"logo_box ".concat(n.props.style.alignmentType.className," ")+"".concat(n.props.style.colorScheme.className," ")+"".concat(k.ALL.className)},o.a.createElement(I,{id:"sequence_logo",alignment:n.props.alignment,glyphWidth:n.state.aceCharacterWidth,logoType:n.props.logoPlotStyle}))},n.renderConservationBox=function(){return o.a.createElement(W,{id:"sequence_conservation",alignment:n.props.alignment,characterWidth:n.state.aceCharacterWidth})},n.renderConsensusQueryBox=function(){return o.a.createElement("div",{className:"consensusseq_box"},o.a.createElement(ne,{id:"ace-consensusseq",alignment:n.props.alignment,fontSize:n.props.zoomLevel,sortBy:n.props.sortBy,classNames:[n.props.style.residueDetail.className,n.props.style.alignmentType.className,n.props.style.positionsToStyle.className,n.props.style.colorScheme.className].join(" "),editorLoaded:function(e){n._aceEditorLoaded("ace-consensusseq",e,q.horizontal)}}))},n.renderQuerySeqBox=function(){return o.a.createElement("div",{className:"queryseq_box"},o.a.createElement(re,{id:"ace-queryseq",alignment:n.props.alignment,fontSize:n.props.zoomLevel,sortBy:n.props.sortBy,classNames:[n.props.style.residueDetail.className,n.props.style.alignmentType.className,n.props.style.positionsToStyle.className,n.props.style.colorScheme.className].join(" "),editorLoaded:function(e){n._aceEditorLoaded("ace-queryseq",e,q.horizontal)}}))},n.renderPositionBox=function(){return o.a.createElement("div",{className:"position_box"},o.a.createElement(oe,{id:"ace-positions",alignment:n.props.alignment,fontSize:n.props.zoomLevel,editorLoaded:function(e){n._aceEditorLoaded("ace-positions",e,q.horizontal)},mouseEnter:function(){},mouseLeave:function(){},mouseMove:function(e){},mouseDown:function(e){}}))},n.renderAlignmentBox=function(){return o.a.createElement("div",{className:"alignment_box"},o.a.createElement(te,{id:"ace-alignment",alignment:n.props.alignment,fontSize:n.props.zoomLevel,sortBy:n.props.sortBy,classNames:[n.props.style.residueDetail.className,n.props.style.alignmentType.className,n.props.style.positionsToStyle.className,n.props.style.colorScheme.className].join(" "),characterSizeChanged:n._handleCharacterSizeChanged,editorLoaded:function(e){n._aceEditorLoaded("ace-alignment",e,q.both)}}))},n.renderAlignmentAnnotationBox=function(){return o.a.createElement("div",{className:"alignment_metadata_box"},o.a.createElement(ee,{id:"ace-alignment-metadata",text:n.props.alignment.getSequences(n.props.sortBy).map((function(e){return e.id})).join("\n"),fontSize:n.props.zoomLevel,editorLoaded:function(e){n._aceEditorLoaded("ace-alignment-metadata",e,q.vertical)}}))},n.onMinimapClick=function(e,t){var r=n.state,o=r.aceEditors,a=r.alignmentEditorVisibleFirstRow,i=r.alignmentEditorVisibleLastRow,s=40;void 0!==a&&void 0!==i&&(s=i-a),o.length>=1&&o[0].scrollToRow(Math.floor(t-s/2))},n.state={aceEditors:[],aceCharacterWidth:0},P.getInstance().setScrollerGroup("horizontal",q.horizontal),P.getInstance().setScrollerGroup("vertical",q.vertical),n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"generateWidget",value:function(e,t,n,r){return o.a.createElement("div",{className:"av-widget ".concat(e)},o.a.createElement("div",{className:"av-annotation"},t),o.a.createElement("div",{className:"av-content",ref:function(e){e&&r&&P.getInstance().registerScroller(e,"horizontal",!0)}},n))}},{key:"render",value:function(){if(!this.props.alignment)return null;var e=this.props.showAnnotations?"":" annotation-closed";return o.a.createElement("div",{className:"alignment_viewer".concat(e)},this.renderMiniMap(),this.generateWidget("av-conservation-gaps","Conservation / gaps:",this.renderConservationBox(),!0),this.generateWidget("av-sequence-logo","Logo:",this.renderSequenceLogo(),!0),this.generateWidget("av-consensus-seq","Consensus sequence:",this.renderConsensusQueryBox()),this.generateWidget("av-target-seq","Query sequence:",this.renderQuerySeqBox()),this.generateWidget("av-position-indicator","Position:",this.renderPositionBox()),this.generateWidget("av-ace-msa",this.renderAlignmentAnnotationBox(),this.renderAlignmentBox()))}},{key:"renderMiniMap",value:function(){var e=this.props,t=e.alignment,n=e.sortBy,r=e.style,a=e.showMiniMap?"mini-map":"mini-map hidden";return t&&r&&o.a.createElement("div",{className:a},o.a.createElement(J,{width:t.getMaxSequenceLength(),height:window.innerHeight,alignHorizontal:"right",alignment:t,style:r,sortBy:n,highlightRows:void 0!==this.state.alignmentEditorVisibleFirstRow&&void 0!==this.state.alignmentEditorVisibleLastRow?[this.state.alignmentEditorVisibleFirstRow,this.state.alignmentEditorVisibleLastRow]:void 0,onClick:this.onMinimapClick}))}}]),t}(o.a.Component),ie=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).fileInput=void 0,n.handleSubmit=n.handleSubmit.bind(Object(B.a)(n)),n.fileInput=r.createRef(),n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"handleSubmit",value:function(e){var t=this.props.onFileLoadCb;e.preventDefault(),t&&this.fileInput.current&&this.fileInput.current.files&&t(this.fileInput.current.files[0],e)}},{key:"render",value:function(){var e=this.props.labelText;return r.createElement("label",null,r.createElement("strong",null,e),r.createElement("input",{type:"file",ref:this.fileInput,onInput:this.handleSubmit}))}}]),t}(r.Component);ie.defaultProps={labelText:"Upload:"};var se=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).renderSettingsBox=function(e){var t=n.state.alignment,r=t?o.a.createElement("h3",null,t.getName()):o.a.createElement(o.a.Fragment,null);return o.a.createElement("div",{className:"settings_box"},o.a.createElement("form",null,o.a.createElement("div",{className:"settings-header"},o.a.createElement("button",{style:{display:n.state.showSettings?"none":"block"},type:"button",className:"button-link",onClick:function(e){n.setState({showSettings:!0})}},"Expand"),o.a.createElement("button",{style:{display:n.state.showSettings?"block":"none"},type:"button",className:"button-link",onClick:function(e){n.setState({showSettings:!1})}},"Hide"),o.a.createElement("div",null,o.a.createElement("h2",null,"AlignmentViewer 2.0 Settings Demo"),r)),o.a.createElement("div",{style:{display:n.state.showSettings?"block":"none"}},n.renderAlignmentTypeLabel(e),n.renderSortControl(),n.renderColorScheme(e),n.renderResidueDetail(e),n.renderPositionStyling(e),n.renderSequenceLogo(),n.renderZoomButtons(),n.renderMiniMapToggle(),n.renderAnnotationToggle(),o.a.createElement("br",null),n.renderFileUpload(),n.renderExampleLinks())))},n.renderSortControl=function(){var e=n.state.sortBy;return o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("strong",null,"Sort order:"),o.a.createElement("select",{value:e.key,onChange:function(e){return n.setState({sortBy:_.fromKey(e.target.value)})}},_.list.map((function(e){return o.a.createElement("option",{value:e.key,key:e.key},e.description)})))))},n.renderAlignmentTypeLabel=function(e){return o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("strong",null,"Alignment Type:"),o.a.createElement("select",{value:e.alignmentType.key,onChange:function(e){return n.setState({style:M.fromAlignmentType(w.fromKey(e.target.value))})}},w.list.map((function(e){return o.a.createElement("option",{value:e.key,key:e.key},e.description)})))))},n.renderColorScheme=function(e){return o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("strong",null,"Style:"),o.a.createElement("select",{value:e.alignmentType.allColorSchemes.indexOf(e.colorScheme),onChange:function(t){n.setState({style:Object(c.a)({},e,{colorScheme:e.alignmentType.allColorSchemes[parseInt(t.target.value)]})})}},e.alignmentType.allColorSchemes.map((function(e,t){return o.a.createElement("option",{key:t,value:t},e.description)})))))},n.renderResidueDetail=function(e){return o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("strong",null,"Residue Detail:"),o.a.createElement("select",{value:e.residueDetail.key,onChange:function(t){n.setState({style:Object(c.a)({},e,{residueDetail:O.fromKey(t.target.value)})})}},O.list.map((function(e){return o.a.createElement("option",{key:e.key,value:e.key},e.description)})))))},n.renderPositionStyling=function(e){return o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("strong",null,"Positions to Style:"),o.a.createElement("select",{value:k.list.indexOf(e.positionsToStyle),onChange:function(t){n.setState({style:Object(c.a)({},e,{positionsToStyle:k.list[parseInt(t.target.value)]})})}},k.list.map((function(e,t){return o.a.createElement("option",{key:t,value:t},e.description)})))))},n.renderSequenceLogo=function(){var e=n.state.logoPlotStyle;return o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("strong",null,"Sequence Logo Style:"),o.a.createElement("select",{value:e,onChange:function(e){n.setState({logoPlotStyle:e.target.value})}},Object.values(z).map((function(e){return o.a.createElement("option",{key:e,value:e},e)})))))},n.renderZoomButtons=function(){var e=n.state.zoomLevel;return o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("strong",null,"Character size:"),o.a.createElement("div",{className:"zoom-level"},o.a.createElement("button",{type:"button",disabled:e<3,onClick:function(t){n.setState({zoomLevel:e-1})}},"-"),e,o.a.createElement("button",{type:"button",disabled:e>15,onClick:function(t){n.setState({zoomLevel:e+1})}},"+"))))},n.renderFileUpload=function(){return o.a.createElement("div",null,o.a.createElement(ie,{labelText:"Upload Sequence File:",onFileLoadCb:n.onFileUpload}))},n.renderExampleLinks=function(){return o.a.createElement("div",{className:"examples"},o.a.createElement("label",null,o.a.createElement("strong",null,"Example Alignments:"),o.a.createElement("button",{type:"button",className:"button-link",onClick:function(e){var t;return l.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=File,e.t1=l.a,e.next=4,l.a.awrap(fetch("".concat("/AlignmentViewer2.0","/7fa1c5691376beab198788a726917d48_b0.4.a2m")));case 4:return e.t2=e.sent.blob(),e.next=7,e.t1.awrap.call(e.t1,e.t2);case 7:e.t3=e.sent,e.t4=[e.t3],t=new e.t0(e.t4,"beta_lactamase_example.fasta"),n.onFileUpload(t);case 11:case"end":return e.stop()}}))}},"\u03b2-lactamase")))},n.renderMiniMapToggle=function(){return o.a.createElement("div",{className:"minimap-toggle"},o.a.createElement("label",null,o.a.createElement("strong",null,"Show MiniMap:"),o.a.createElement("input",{name:"showMiniMap",type:"checkbox",checked:n.state.showMiniMap,onChange:function(e){var t=e.target;n.setState({showMiniMap:t.checked})}})))},n.renderAnnotationToggle=function(){return o.a.createElement("div",{className:"annotation-toggle"},o.a.createElement("label",null,o.a.createElement("strong",null,"Show Annotations:"),o.a.createElement("input",{name:"showAnnotations",type:"checkbox",checked:n.state.showAnnotations,onChange:function(e){var t=e.target;n.setState({showAnnotations:t.checked})}})))},n.onFileUpload=function(e){var t;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,l.a.awrap(e.text());case 2:t=r.sent,n.setState({alignment:D.fromFileContents(e.name,t)});case 4:case"end":return r.stop()}}))},n.state={style:new A,logoPlotStyle:z.LETTERS,zoomLevel:12,sortBy:_.INPUT,showMiniMap:!1,showAnnotations:!0,showSettings:!0},n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){return l.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}},{key:"render",value:function(){var e=this.state,t=e.alignment,n=e.logoPlotStyle,r=e.showAnnotations,a=e.showMiniMap,i=e.sortBy,s=e.style,l=e.zoomLevel,c=t?o.a.createElement("div",{className:"av_holder"},o.a.createElement(ae,{alignment:t,style:s,logoPlotStyle:n,zoomLevel:l,sortBy:i,showMiniMap:a,showAnnotations:r})):o.a.createElement(o.a.Fragment,null);return o.a.createElement("div",null,this.renderSettingsBox(s),c)}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(se,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},7:function(e,t,n){e.exports={acePrefix:"ace_",preAceQueryClass:"query",preAceConsensusClass:"consensus",aceQueryClass:"ace_query",aceConsensusClass:"ace_consensus",transparentLetterClass:"transparent-letters",transparentBackgroundClass:"transparent-background",aaAlignTypeClass:"alignment-aa",ntAlignTypeClass:"alignment-nt",styPosAllClass:"alignment-positions-tostyle-all",styPosQueryClass:"alignment-positions-tostyle-query",styPosQueryDiffClass:"alignment-positions-tostyle-query-diff",styPosConsensusClass:"alignment-positions-tostyle-consensus",styPosConsensusDiffClass:"alignment-positions-tostyle-consensus-diff",aaStyClass_Default:"aa-alignment-style-default",aaStyDesc_Default:"Default",aaStyBGAlpha_Default:".25",aaStyColorOrder_Default:"A,R,N,D,C,Q,E,G,H,I,L,K,M,F,P,S,T,W,Y,V",aaStyColors_Default:"#3c0,#c00,#60c,#03f,#ff0,#60c,#03f,#3c0,#090,#3c0,#3c0,#c00,#3c0,#090,#3c0,#09f,#09f,#090,#090,#3c0",aaStyClass_Hydrophobicity:"aa-alignment-style-hydrophobicity",aaStyDesc_Hydrophobicity:"Hydrophobicity",aaStyBGAlpha_Hydrophobicity:".25",aaStyColorOrder_Hydrophobicity:"F,I,W,L,V,M,Y,C,A,T,H,G,S,Q,R,K,N,E,P,D",aaStyColors_Hydrophobicity:"red,red,#ff0606,#ff0606,#ff4c4c,#ff5252,#f77,#ffa5a5,#ffc0c0,#e1e1ff,#d0d0ff,#b6b6ff,#a5a5ff,#9595ff,#8787ff,#6969ff,#5959ff,#4f4fff,#1d1dff,blue",ntStyClass_Default:"nt-alignment-style-default",ntStyDesc_Default:"Default",ntStyBGAlpha_Default:".25",ntStyColorOrder_Default:"A,C,G,T,U,R,Y",ntStyColors_Default:"#5050ff,#e00000,#00c000,#e6e600,#c90,#2e8b57,#ff8c00"}}},[[29,1,2]]]);
//# sourceMappingURL=main.ddbf9e7b.chunk.js.map