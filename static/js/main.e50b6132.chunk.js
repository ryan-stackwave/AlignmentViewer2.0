(this["webpackJsonpalignment-viewer-2"]=this["webpackJsonpalignment-viewer-2"]||[]).push([[0],{29:function(e,t,n){e.exports=n(48)},34:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(25),i=n.n(o),s=(n(34),n(14)),l=n.n(s),c=n(8),u=n(1),h=n(2),d=n(5),p=n(4),m=n(6),g=(n(36),n(11));function f(e){var t=document.createElement("canvas").getContext("2d");t.fillStyle=e;var n=t.fillStyle;n=n.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,r){return"#"+t+t+n+n+r+r}));var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return{hex:n,rgb:{red:parseInt(r[1],16),green:parseInt(r[2],16),blue:parseInt(r[3],16)}}}var y=n(16),v=n.n(y),L=n(7),b=n.n(L),E=C("aa"),S=C("nt");function C(e){return Object.keys(b.a).reduce((function(t,n){if(-1!==n.indexOf(e+"StyClass_")){var r=n.split(e+"StyClass_")[1],a=b.a[e+"StyColorOrder_"+r].replace(/ /g,"").split(","),o=b.a[e+"StyColors_"+r].replace(/ /g,"").split(","),i=b.a[e+"StyDesc_"+r];t.push({commonName:r,description:i,className:b.a[n],backgroundAlpha:parseFloat(b.a[e+"StyBGAlpha_"+r]),colors:Object.fromEntries(a.map((function(e,t){return[a[t],o[t]]})))})}return t}),[])}var w=function(){function e(t,n,r,a){Object(u.a)(this,e),this.key=t,this.description=n,this.className=r,this.allColorSchemes=a}return Object(h.a)(e,null,[{key:"fromKey",value:function(t){return e.list.find((function(e){return e.key===t}))}}]),e}();w.AMINOACID=new w("aminoacid-alignment","Amino Acid Sequences",b.a.aaAlignTypeClass,E),w.NUCLEOTIDE=new w("nucleotide-alignment","Nucleotide Sequences",b.a.ntAlignTypeClass,S),w.list=[w.AMINOACID,w.NUCLEOTIDE];var k=function(){function e(t,n,r){Object(u.a)(this,e),this.key=t,this.description=n,this.className=r}return Object(h.a)(e,null,[{key:"fromKey",value:function(t){return e.list.find((function(e){return e.key===t}))}}]),e}();k.ALL=new k("all","All",b.a.styPosAllClass),k.QUERY=new k("query","Same as Query",b.a.styPosQueryClass),k.QUERY_DIFF=new k("query-diff","Different from Query",b.a.styPosQueryDiffClass),k.CONSENSUS=new k("consensus","Same as Consensus",b.a.styPosConsensusClass),k.CONSENSUS_DIFF=new k("consensus-diff","Different from Consensus",b.a.styPosConsensusDiffClass),k.list=[k.ALL,k.QUERY,k.QUERY_DIFF,k.CONSENSUS,k.CONSENSUS_DIFF];var O=function(){function e(t,n,r){Object(u.a)(this,e),this.key=t,this.description=n,this.className=r}return Object(h.a)(e,null,[{key:"fromKey",value:function(t){return e.list.find((function(e){return e.key===t}))}}]),e}();O.BOTH=new O("both","Style Background and Letters",""),O.LETTER_ONLY=new O("letter-only","Only Style Letters",b.a.transparentBackgroundClass),O.BACKGROUND_ONLY=new O("background-only","Only Style Background",b.a.transparentLetterClass),O.list=[O.BOTH,O.LETTER_ONLY,O.BACKGROUND_ONLY];var T=function(){function e(){Object(u.a)(this,e),this.alignmentType=void 0,this.colorScheme=void 0,this.positionsToStyle=void 0,this.residueDetail=void 0}return Object(h.a)(e,null,[{key:"fromAlignmentType",value:function(e){return e===w.AMINOACID?new M:new N}}]),e}(),M=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k.ALL,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O.BOTH;Object(u.a)(this,e),this.colorScheme=t,this.positionsToStyle=n,this.residueDetail=r,this.allColorSchemes=E,this.alignmentType=w.AMINOACID},N=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k.ALL,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O.BOTH;Object(u.a)(this,e),this.colorScheme=t,this.positionsToStyle=n,this.residueDetail=r,this.allColorSchemes=S,this.alignmentType=w.NUCLEOTIDE};b.a.transparentLetterClass,b.a.transparentBackgroundClass;b.a.acePrefix;function j(e,t,n){var r=" "+b.a.aceLetterObjClass,a=t?" "+b.a.aceConsensusClass:"",o=n?" "+b.a.aceQueryClass:"";return b.a.acePrefix+e+r+a+o}function A(e,t){var n=e.split("/");if(3!==n.length||"ace"!==n[0]||"mode"!==n[1])throw Error("ace mode name must be of the form '/ace/mode/MODENAME'");var r=e.split("/")[2];v.a.define("ace/mode/"+r+"_highlight_rules",(function(e,n,r){var a=e("../lib/oop"),o=e("./text_highlight_rules").TextHighlightRules,i=function(){for(var e={},n=function(n){var r=0===n?"start":"pos"+n,a=n===t.getMaxSequenceLength()-1?"start":"pos"+(n+1);e[r]=[{token:function(e){return function(e,t,n){return e+("."+b.a.preAceLetterObjClass)+(t?"."+b.a.preAceConsensusClass:"")+(n?"."+b.a.preAceQueryClass:"")}(e,e===t.getConsensus()[n].letter,e===t.getTargetSequence().sequence[n])},regex:".",next:a}]},r=0;r<t.getMaxSequenceLength();r++)n(r);this.$rules=e};a.inherits(i,o),n.AlignmentHighlightRules=i})),v.a.define("ace/mode/"+r,(function(e,t,n){var a=e("../lib/oop"),o=e("../mode/text").Mode,i=e("../tokenizer").Tokenizer,s=e("ace/mode/"+r+"_highlight_rules").AlignmentHighlightRules,l=function(){this.$tokenizer=new i((new s).getRules())};a.inherits(l,o),function(){}.call(l.prototype),t.Mode=l}))}var x=function(){function e(){Object(u.a)(this,e),this.letterToGlyphHM={A:e.A,B:e.B,C:e.C,D:e.D,E:e.E,F:e.F,G:e.G,H:e.H,I:e.I,J:e.J,K:e.K,L:e.L,M:e.M,N:e.N,O:e.O,P:e.P,Q:e.Q,R:e.R,S:e.S,T:e.T,U:e.U,V:e.V,W:e.W,X:e.X,Y:e.Y,Z:e.Z}}return Object(h.a)(e,null,[{key:"glyphFromChar",value:function(t){return e.singleton||(e.singleton=new e),e.singleton.letterToGlyphHM[t]}}]),e}();x.singleton=void 0,x.A=function(e){return a.a.createElement("g",{key:e.key+"_g"},a.a.createElement("path",Object.assign({},e,{d:"M 0 100 L 33 0 L 66 0 L 100 100 L 75 100 L 66 75 L 33 75 L 25 100 L 0 100"})),a.a.createElement("path",{key:e.key+"_p2",transform:e.transform,fill:"#ffffff",d:"M 41 55 L 50 25 L 58 55 L 41 55"}))},x.B=function(e){return a.a.createElement("g",{key:e.key+"_g"},a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 80 0 C 105 0 105 50 80 50 C 105 50 105 100 80 100 L 00 100 L 0 0"})),a.a.createElement("path",{key:e.key+"_p2",transform:e.transform,d:"M 20 15 L 70 15 C 80 15 80 35 70 35 L 20 35 L 20 15",fill:"#ffffff"}),a.a.createElement("path",{key:e.key+"_p3",transform:e.transform,d:"M 20 65 L 70 65 C 80 65 80 85 70 85 L 20 85 L 20 65",fill:"#ffffff"}))},x.C=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 100 28 C 100 -13 0 -13 0 50 C 0 113 100 113 100 72 L 75 72 C 75 90 30 90 30 50 C 30 10 75 10 75 28 L 100 28"}))},x.D=function(e){return a.a.createElement("g",{key:e.key+"_g"},a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 60 0 C 110 0 110 100 60 100 L 0 100 L 0 0"})),a.a.createElement("path",{key:e.key+"_p2",transform:e.transform,fill:"#ffffff",d:"M 20 15 L 40 15 C 85 15 85 85 40 85 L 20 85 L 20 15"}))},x.E=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 100 0 L 100 20 L 20 20 L 20 40 L 90 40 L 90 60 L 20 60 L 20 80 L 100 80 L 100 100 L 0 100 L 0 0"}))},x.F=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 100 0 L 100 20 L 20 20 L 20 40 L 80 40 L 80 60 L 20 60 L 20 100 L 0 100 L 0 0"}))},x.G=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 100 28 C 100 -13 0 -13 0 50 C 0 113 100 113 100 72 L 100 48 L 55 48 L 55 72 L 75 72 C 75 90 30 90 30 50 C 30 10 75 5 75 28 L 100 28"}))},x.H=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 20 40 L 80 40 L 80 0 L 100 0 L 100 100 L 80 100 L 80 60 L 20 60 L 20 100 L 0 100 L 0 0"}))},x.I=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 40 0 L 60 0 L 60 100 L 40 100 L 40 0"}))},x.J=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 60 C 0 111 100 111 100 60 L 100 0 L 75 0 L 75 60 C 80 90 20 90 25 60"}))},x.K=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 20 40 L 75 0 L 100 0 L 50 50 L 100 100 L 75 100 L 30 65 L 20 75 L 20 100 L 0 100 L 0 0"}))},x.L=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 0 100 L 100 100 L 100 80 L 20 80 L 20 0 L 0 0"}))},x.M=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 50 35 L 80 0 L 100 0 L 100 100 L 80 100 L 80 30 L 50 65 L 20 30 L 20 100 L 0 100 L 0 0"}))},x.N=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 100 L 0 0 L 20 0 L 80 75 L 80 0 L 100 0 L 100 100 L 80 100 L 20 25 L 20 100 L 0 100"}))},x.O=function(e){return a.a.createElement("g",{key:e.key+"_g"},a.a.createElement("circle",Object.assign({cx:"50",cy:"50",r:"50"},e)),a.a.createElement("circle",{key:e.key+"_c2",transform:e.transform,cx:"50",cy:"50",r:"32",fill:"#ffffff"}))},x.P=function(e){return a.a.createElement("g",{key:e.key+"_g"},a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 80 0 C 105 0 105 50 80 50 L 20 50 L 20 100 L 0 100 L 0 0"})),a.a.createElement("path",{key:e.key+"_p2",transform:e.transform,fill:"#ffffff",d:"M 20 15 L 70 15 C 80 15 80 35 70 35 L 20 35 L 20 15"}))},x.Q=function(e){return a.a.createElement("g",{key:e.key+"_g"},a.a.createElement("circle",Object.assign({cx:"50",cy:"50",r:"50"},Object(c.a)({},e,{key:e.key+"_c1"}))),a.a.createElement("circle",{key:e.key+"_c2",transform:e.transform,cx:"50",cy:"50",r:"32",fill:"#ffffff"}),a.a.createElement("path",Object.assign({d:"M 85 100 L 55 70 L 70 55 L 100 85 L 85 100"},e)))},x.R=function(e){return a.a.createElement("g",{key:e.key+"_g"},a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 80 0 C 105 0 105 50 80 50 C 100 50 100 70 100 70 L 100 100 L 80 100 L 80 80 C 80 80 80 60 50 60 L 20 60 L 20 100 L 0 100 L 0 0"})),a.a.createElement("path",{key:e.key+"_p2",transform:e.transform,fill:"#ffffff",d:"M 20 15 L 70 15 C 80 15 80 35 70 35 L 20 35 L 20 15"}))},x.S=function(e){return e.stroke||(e.stroke=e.fill),e.strokeOpacity||(e.strokeOpacity=e.fillOpacity),a.a.createElement("path",Object.assign({fill:"#ffffff"},e,{strokeWidth:"18",d:"M92 26 A43 20 0 1 0 43 46 A42 23 0 1 1 9 68"}))},x.T=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 0 20 L 35 20 L 35 100 L 65 100 L 65 20 L 100 20 L 100 0 L 0 0"}))},x.U=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 0 60 C 0 111 100 111 100 60 L 100 0 L 75 0 L 75 60 C 80 90 20 90 25 60 L 25 0 L 0 0"}))},x.V=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 50 80 L 80 0 L 100 0 L 60 100 L 40 100 L 0 0"}))},x.W=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 30 70 L 50 30 L 70 70 L 80 0 L 100 0 L 90 100 L 70 100 L 50 65 L 30 100 L 10 100 L 0 0"}))},x.X=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 50 40 L 80 0 L 100 0 L 70 50 L 100 100 L 80 100 L 50 60 L 20 100 L 0 100 L 30 50 L 0 0"}))},x.Y=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 50 45 L 80 0 L 100 0 L 60 60 L 60 100 L 40 100 L 40 60 L 0 0"}))},x.Z=function(e){return a.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 100 0 L 100 20 L 35 80 L 100 80 L 100 100 L 0 100 L 0 80 L 65 20 L 0 20 L 0 0"}))};var _=function(){function e(t,n,r){Object(u.a)(this,e),this.singleLetterCode=t,this.threeLetterCode=n,this.fullName=r,this.glyph=void 0,this.colors=void 0,this.singleLetterCode=t,this.threeLetterCode=n,this.fullName=r,this.glyph=x.glyphFromChar(t),this.colors=E.reduce((function(e,n){var r=Object.entries(n.colors).find((function(e){var n=Object(g.a)(e,2),r=n[0];n[1];return r===t})),a="#ffffff";r&&(a=r[1]);var o=f(a);return e[n.commonName]={hexString:o.hex,rgb:o.rgb,backgroundAlpha:n.backgroundAlpha},e}),{})}return Object(h.a)(e,null,[{key:"fromSingleLetterCode",value:function(t){return t in this.bySingleLetterCode?e.bySingleLetterCode[t]:e.UNKNOWN}},{key:"fromThreeLetterCode",value:function(t){return t in this.byThreeLetterCode?e.byThreeLetterCode[t]:e.UNKNOWN}}]),e}();_.canonicalAminoAcids=[new _("A","ALA","Alanine"),new _("R","ARG","Arginine"),new _("N","ASN","Asparagine"),new _("D","ASP","Aspartic Acid"),new _("C","CYS","Cysteine"),new _("Q","GLU","Glutamine"),new _("E","GLN","Glutamic Acid"),new _("G","GLY","Glycine"),new _("H","HIS","Histidine"),new _("I","ILE","Isoleucine"),new _("L","LEU","Leucine"),new _("K","LYS","Lysine"),new _("M","MET","Methionine"),new _("F","PHE","Phenylalanine"),new _("P","PRO","Proline"),new _("S","SER","Serine"),new _("T","THR","Threonine"),new _("W","TRP","Tryptophan"),new _("Y","TYR","Tyrosine"),new _("V","VAL","Valine"),new _("X","UKN","Unknown Amino Acid")],_.bySingleLetterCode=_.canonicalAminoAcids.reduce((function(e,t){return e[t.singleLetterCode]=t,e}),{}),_.byThreeLetterCode=_.canonicalAminoAcids.reduce((function(e,t){return e[t.threeLetterCode]=t,e}),{}),_.UNKNOWN=_.bySingleLetterCode.X;var q,D=function(){function e(t,n){Object(u.a)(this,e),this.singleLetterCode=t,this.fullName=n,this.glyph=void 0,this.colors=void 0,this.singleLetterCode=t,this.fullName=n,this.glyph=x.glyphFromChar(t),this.colors=S.reduce((function(e,n){var r=Object.entries(n.colors).find((function(e){var n=Object(g.a)(e,2),r=n[0];n[1];return r===t})),a="#ffffff";r&&(a=r[1]);var o=f(a);return e[n.commonName]={hexString:o.hex,rgb:o.rgb,backgroundAlpha:n.backgroundAlpha},e}),{})}return Object(h.a)(e,null,[{key:"fromSingleLetterCode",value:function(t){return t in this.bySingleLetterCode?e.bySingleLetterCode[t]:e.UNKNOWN}}]),e}();D.allNucleotides=[new D("A","Adenine"),new D("C","Cytosine"),new D("G","Guanine"),new D("T","Thymidine"),new D("U","Uracil"),new D("R","Purine"),new D("Y","Pyrimidine"),new D("X","Unknown Nucleotide")],D.bySingleLetterCode=D.allNucleotides.reduce((function(e,t){return e[t.singleLetterCode]=t,e}),{}),D.UNKNOWN=D.bySingleLetterCode.X,function(e){e[e.hamming=0]="hamming"}(q||(q={}));var H=function(){function e(t,n,r,a){Object(u.a)(this,e),this.key=t,this.description=n,this.isTargetSequenceDependent=r,this.distanceFn=a}return Object(h.a)(e,null,[{key:"fromKey",value:function(t){return e.list.find((function(e){return e.key===t}))}}]),e}();H.INPUT=new H("as-input","As input",!1),H.HAMMING_DIST_TARGET=new H("hamming-dist-to-target","Hamming distance to target sequence",!0,q.hamming),H.list=[H.INPUT,H.HAMMING_DIST_TARGET];var P,W=function(){function e(t,n){var r=this;Object(u.a)(this,e),this.uuid=void 0,this.aceEditorMode=void 0,this.name=void 0,this.predictedNT=void 0,this.sequences=void 0,this.targetSequence=void 0,this.positionalLetterCounts=new Map,this.globalAlphaLetterCounts={},this.allAlphaLettersSorted=void 0,this.consensus=[],this.uuid=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(parseInt(e)^window.crypto.getRandomValues(new Uint8Array(1))[0]&15>>parseInt(e)/4).toString(16)})),this.name=t,this.sequences=new Map,this.sequences.set(H.INPUT,n),this.targetSequence=n[0],this.predictedNT=!0;for(var a=new Date,o={},i=0;i<n.length;i++)for(var s=n[i].sequence,l=0;l<s.length;l++){var c=s[l].toUpperCase(),h=!!c.match(/[a-z]/i);h&&this.predictedNT&&D.fromSingleLetterCode(c)===D.UNKNOWN&&(this.predictedNT=!1);var d=l;o[c]=1;var p=this.positionalLetterCounts.get(d);p||(p={},this.positionalLetterCounts.set(d,p)),c in p===!1&&(p[c]=0),p[c]+=1,h&&(c in this.globalAlphaLetterCounts===!1&&(this.globalAlphaLetterCounts[c]=0),this.globalAlphaLetterCounts[c]+=1)}this.allAlphaLettersSorted=Object.keys(o).sort().reduce((function(e,t){return t.match(/[a-z]/i)&&e.push(t),e}),[]),this.consensus=Array.from(this.positionalLetterCounts).map((function(e){var t=Object(g.a)(e,2),n=t[0],a=t[1],o=r.allAlphaLettersSorted.reduce((function(e,t){return e in a===!1||a[e]<a[t]?t:e}));return{position:n,letter:o,occurrences:a[o]}})),console.log("done parsing alignment. took "+((new Date).getTime()-a.getTime())+"ms")}return Object(h.a)(e,null,[{key:"fromFileContents",value:function(t,n){for(var r=n.split(">"),a=[],o=0;o<r.length;o++){var i=r[o].split(/\r?\n/);if(i.length>1){var s={id:i[0],sequence:i.slice(1).join("")};a.push(s)}}return new e(t,a)}},{key:"getSequenceDistance",value:function(e,t,n){var r=e.sequence.length<t.sequence.length?e.sequence.length:t.sequence.length,a=0;if(n===q.hamming){for(var o=0;o<r;o++)e.sequence[o]!==t.sequence[o]&&(a+=1);return a}throw Error("Unable to determine sequence distance with distance function "+n)}},{key:"normalizeLetterCounts",value:function(e,t){var n=Object.keys(e).reduce((function(n,r){return t&&!t.includes(r)||(n+=e[r]),n}),0);return Object.keys(e).reduce((function(r,a){return t&&!t.includes(a)||(r[a]=e[a]/n),r}),{})}}]),Object(h.a)(e,[{key:"getPredictedType",value:function(){return this.predictedNT?w.NUCLEOTIDE:w.AMINOACID}},{key:"getUUID",value:function(){return this.uuid}},{key:"getName",value:function(){return this.name}},{key:"getAceEditorMode",value:function(){return this.aceEditorMode||(this.aceEditorMode="ace/mode/"+this.uuid,A(this.aceEditorMode,this)),this.aceEditorMode}},{key:"getConsensus",value:function(){return this.consensus}},{key:"getGapsPerColumn",value:function(){return Array.from(this.positionalLetterCounts).map((function(e){var t=Object(g.a)(e,2),n=(t[0],t[1]);return isNaN(n["-"])?0:n["-"]}))}},{key:"getGlobalAlphaLetterCounts",value:function(t,n){return t?e.normalizeLetterCounts(this.globalAlphaLetterCounts,n):this.globalAlphaLetterCounts}},{key:"getMaxSequenceLength",value:function(){return this.getSequences().reduce((function(e,t){return t.sequence.length>e&&(e=t.sequence.length),e}),-1)}},{key:"getPositionalLetterCounts",value:function(t,n){return t?Array.from(this.positionalLetterCounts).reduce((function(t,r){var a=Object(g.a)(r,2),o=a[0],i=a[1];return t.set(o,e.normalizeLetterCounts(i,n)),t}),new Map):this.positionalLetterCounts}},{key:"getSequences",value:function(e,t){if(e=e||H.INPUT,t=t||!1,!this.sequences.has(e)||t)switch(e){case H.INPUT:break;case H.HAMMING_DIST_TARGET:this.sequences.set(e,this.sortByDistanceToTargetSequence(H.HAMMING_DIST_TARGET.distanceFn));break;default:throw Error('The sortBy option provided "'.concat(e,'" is not implemented'))}return this.sequences.get(e)}},{key:"getSortedAlphaLetters",value:function(){return this.allAlphaLettersSorted}},{key:"getTargetSequence",value:function(){return this.targetSequence}},{key:"setTargetSequence",value:function(e){var t=this;if(void 0===this.getSequences().find((function(t){return t===e})))throw Error("target sequence does not exist in alignment");this.targetSequence=e,this.sequences.forEach((function(e,n){t.getSequences(n,!0)}))}},{key:"sortByDistanceToTargetSequence",value:function(t){var n=this,r=this.getSequences();switch(t){case q.hamming:return r.map((function(e){return e})).sort((function(t,r){return e.getSequenceDistance(n.targetSequence,t,q.hamming)-e.getSequenceDistance(n.targetSequence,r,q.hamming)}));default:throw Error('The distFn option provided "'.concat(t,'" is not implemented'))}}}]),e}();n(37);!function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal",e[e.both=2]="both"}(P||(P={}));var z,R=function(){function e(){Object(u.a)(this,e),this._groupScrollpropsHM={},this._lastScrollerOffsets=new Map,this._blockNextHorizontalScrollEvent=new Map,this._blockNextVerticalScrollEvent=new Map}return Object(h.a)(e,[{key:"_setScrollerLastOffsets",value:function(e){}},{key:"_getAceMaxScrollWidth",value:function(e){return e.renderer.$getLongestLine()+2*e.renderer.$padding-e.renderer.$size.scrollerWidth}},{key:"_handleScrollEvent",value:function(e,t,n,r){var a=this;this._blockNextHorizontalScrollEvent.get(e)||(this._setScrollerLastOffsets(e),this._groupScrollpropsHM[t].scrollers.forEach((function(t){t!==e&&("renderer"in t?r===P.horizontal&&t.session.getScrollLeft()!==n?(a._blockNextHorizontalScrollEvent.set(t,!0),t.session.setScrollLeft(n)):r===P.vertical&&t.session.getScrollTop()!==n&&(a._blockNextVerticalScrollEvent.set(t,!0),t.session.setScrollTop(n)):r===P.horizontal&&t.scrollLeft!==n?(a._blockNextHorizontalScrollEvent.set(t,!0),t.scrollLeft=n):r===P.vertical&&t.scrollTop!==n&&(a._blockNextVerticalScrollEvent.set(t,!0),t.scrollTop=n))})));this._blockNextHorizontalScrollEvent.set(e,!1)}},{key:"setScrollerGroup",value:function(e,t){this._groupScrollpropsHM[e]={scrolltype:t,scrollers:this._groupScrollpropsHM[e]?this._groupScrollpropsHM[e].scrollers:[]}}},{key:"registerScroller",value:function(e,t,n){var r=this,a=this._groupScrollpropsHM[t];if(!a)throw new Error('Error: attempt to register scroll sync on unknown group "'.concat(t,'"\n                    please register group first with setScrollerGroup'));if(a.scrollers.includes(e)){if(n)return;throw new Error('Error: attempt to re-add scroller to group "'.concat(t,'"'))}a.scrollers.push(e),this._setScrollerLastOffsets(e),"renderer"in e?(a.scrolltype!==P.both&&a.scrolltype!==P.horizontal||e.session.on("changeScrollLeft",(function(n){r._handleScrollEvent(e,t,Math.round(e.session.getScrollLeft()),P.horizontal)})),a.scrolltype!==P.both&&a.scrolltype!==P.vertical||e.session.on("changeScrollTop",(function(n){r._handleScrollEvent(e,t,Math.round(e.session.getScrollTop()),P.vertical)}))):e.onscroll=function(n){var o,i=n.target.scrollLeft!==(null===(o=r._lastScrollerOffsets.get(e))||void 0===o?void 0:o.lastLeft)?P.horizontal:P.vertical;a.scrolltype!==P.both&&a.scrolltype!==i||r._handleScrollEvent(e,t,n.target.scrollLeft,i)}}}],[{key:"getInstance",value:function(){return this.singleton||(this.singleton=new e),this.singleton}}]),e}();R.singleton=void 0,function(e){e.LETTERS="letter stack",e.BARS="bar plot"}(z||(z={}));var I=function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(a)))).scrollerDiv=void 0,n.loaded=!1,n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"divLoaded",value:function(e){e&&!this.scrollerDiv&&(this.scrollerDiv=e,this.props.logoLoaded&&this.props.logoLoaded(this.scrollerDiv))}},{key:"shouldComponentUpdate",value:function(e){return!1===this.loaded||this.props.logoType!==e.logoType||this.props.glyphWidth!==e.glyphWidth||this.props.alignment!==e.alignment}},{key:"render",value:function(){var e=this;if(!this.props.alignment||!this.props.glyphWidth)return null;var t=this.props.alignment.getPositionalLetterCounts(),n=this.props.alignment.getSortedAlphaLetters(),r=[];t.forEach((function(e,t){var a=Object.keys(e).reduce((function(t,n){return t+=e[n]}),0),o=n.map((function(t){var n=0;return t in e&&(n=e[t]/a),n}));r.push(o)}));var o=n.map((function(e){return{letter:e,classNames:j(e,!1,!1)}})),i=r.map((function(e,t){return e.map((function(e,t){return{frequency:e,letter:o[t]}})).filter((function(e){return 0!==e.frequency})).sort((function(e,t){return e.frequency>t.frequency?1:-1}))})),s=r.length*this.props.glyphWidth;this.loaded=!0;return console.log(i),a.a.createElement("div",{id:this.props.id,ref:function(t){return e.divLoaded(t)}},a.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 ".concat(i.length," 100"),style:{width:s,height:100},xmlns:"http://www.w3.org/2000/svg"},i.map((function(t,n){return a.a.createElement("g",{transform:"translate(".concat(n,",0)"),key:"p_"+n},function(t){var n=100;return t.map((function(t,r){if(n-=100*t.frequency,e.props.logoType===z.BARS){var o=2/i.length;return a.a.createElement("rect",{width:"100",height:"100",transform:"translate(0, ".concat(n,") scale(").concat(o,",").concat(t.frequency,")"),className:t.letter.classNames,key:"idxrect_".concat(r)})}return x.glyphFromChar(t.letter.letter)({className:t.letter.classNames,transform:"translate(0, ".concat(n,") scale(").concat(.009,",").concat(t.frequency,")"),key:"idxglyph_".concat(r)})}))}(t))}))))}}]),t}(a.a.Component);I.defaultProps={logoType:z.LETTERS};var U=n(28),B=n(10),F=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).scrollerDiv=void 0,n.state={isHovered:!1},n.handleSvgHover=n.handleSvgHover.bind(Object(B.a)(n)),n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"handleSvgHover",value:function(e){this.setState({isHovered:e})}},{key:"computeEntropy",value:function(e,t,n,r){return e.reduce((function(e,r){return r in t&&(e+=t[r]*Math.log(t[r]/n[r])),e}),0)}},{key:"createConservationCountGs",value:function(){var e=this,t=[],n=this.props.alignment.getSortedAlphaLetters(),r=this.props.alignment.getPositionalLetterCounts(!0,n),o=this.props.alignment.getGlobalAlphaLetterCounts(!0,n),i=Array.from(r).map((function(t){var r=Object(g.a)(t,2),a=(r[0],r[1]);return e.computeEntropy(n,a,o)})),s=Math.max.apply(Math,Object(U.a)(i));return i.map((function(e){return e/s*100})).forEach((function(e,n){t.push(a.a.createElement("g",{transform:"translate(".concat(n,",").concat(100-e,")"),key:n},a.a.createElement("rect",{width:.5,height:"".concat(e)})))})),t}},{key:"createGapCountGs",value:function(e){for(var t=[],n=this.props.alignment.getSequences().length,r=this.props.alignment.getGapsPerColumn(),o=0;o<e;o++){var i=r[o]/n*100;t.push(a.a.createElement("g",{transform:"translate(".concat(o+.5,",").concat(100-i,")"),key:o},a.a.createElement("rect",{width:.5,height:i})))}return t}},{key:"divLoaded",value:function(e){e&&!this.scrollerDiv&&(this.scrollerDiv=e,this.props.conservationPlotLoaded&&this.props.conservationPlotLoaded(this.scrollerDiv))}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this;if(!this.props.alignment||!this.props.characterWidth)return null;var t=this.props.alignment.getMaxSequenceLength(),n=this.props.characterWidth*t,r=this.state.isHovered?"conservation hovered":"conservation";return a.a.createElement("div",null,a.a.createElement("div",{style:{backgroundColor:"rgba(255,255,255,0.9)",border:"solid 1px black",position:"absolute",padding:"3px",top:0,right:0,color:"red",visibility:this.state.isHovered?"visible":"hidden",zIndex:1e3}},a.a.createElement("span",{style:{color:"#000000"}},"Entropy"),a.a.createElement("span",{style:{color:"#b7b7b7",paddingLeft:10}},"# Gaps")),a.a.createElement("div",{id:this.props.id,ref:function(t){return e.divLoaded(t)}},a.a.createElement("div",{className:"svg_container"},a.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 ".concat(t," 100"),style:{width:n,height:100},className:r,xmlns:"http://www.w3.org/2000/svg",onMouseEnter:function(){return e.handleSvgHover(!0)},onMouseLeave:function(){return e.handleSvgHover(!1)}},a.a.createElement("g",{className:"gapCount"},this.createGapCountGs(t)),a.a.createElement("g",{className:"entropy"},this.createConservationCountGs())))))}}]),t}(a.a.Component),G=n(3),Y=n(13),Q=n(27),V=Object(Y.PixiComponent)("AlignmentHighlighter",{create:function(e){return new G.Graphics},applyProps:function(e,t,n){var r=n.x,a=n.y,o=n.width,i=n.height,s=n.fillColor,l=n.fillAlpha;e.clear(),e.beginFill(s,l),e.drawRect(r,a,o,i),e.endFill()}}),K=function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).app=void 0,n.scaleX=1,n.scaleY=1,n.renderAlignmentHighlighter=function(e){return a.a.createElement(V,Object(c.a)({fillColor:16711680,fillAlpha:.25},e))},n.onMouseEnter=function(e){document.body.style.overflow="hidden"},n.onMouseLeave=function(e){document.body.style.overflow="auto"},n.onWheel=function(e){},n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"sliderChanged",value:function(e,t){this.app&&this.app.stage.children.forEach((function(n){"x"===t?n.scale.x=e:n.scale.y=e}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.alignment,r=t.alignmentType,o=t.colorScheme,i=t.highlightRows,s=t.id,l=t.positionsToStyle,c=t.sortBy,u=t.stageResolution,h=t.viewportProps;if(!n)return null;var d=n.getSequences().length,p=n.getMaxSequenceLength();G.utils.skipHello(),G.settings.SCALE_MODE=G.SCALE_MODES.NEAREST;var m=i?i[1]-i[0]:void 0;return a.a.createElement("div",{id:s,onWheel:this.onWheel,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},a.a.createElement(Y.Stage,{width:null===u||void 0===u?void 0:u.width,height:null===u||void 0===u?void 0:u.height,options:{transparent:!0}},a.a.createElement(Y.AppContext.Consumer,null,(function(t){return e.app=t,a.a.createElement(a.a.Fragment,null)})),a.a.createElement(Y.AppContext.Consumer,null,(function(t){return a.a.createElement($,Object.assign({app:t,numColumns:p,numRows:d,mouseDown:e.props.mouseDown},h),a.a.createElement(X,{id:"tiled-alignment",alignment:n,alignmentType:r,sortBy:c,colorScheme:o,positionsToStyle:l}),m?a.a.createElement(a.a.Fragment,null,e.renderAlignmentHighlighter({x:0,y:e.props.highlightRows[0],width:p,height:m})):a.a.createElement(a.a.Fragment,null))}))))}}]),t}(a.a.Component);K.defaultProps={mouseDown:function(){},stageResolution:{width:485,height:650},viewportProps:{useDrag:!0,usePinch:!0,useWheel:!0,zoomPercent:0}};var X=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(h.a)(t,[{key:"shouldComponentUpdate",value:function(e){return e.alignment!==this.props.alignment||e.colorScheme!==this.props.colorScheme||e.positionsToStyle!==this.props.positionsToStyle||e.sortBy!==this.props.sortBy}},{key:"render",value:function(){if(!this.props.alignment)return null;for(var e=this.props,t=e.alignment,n=e.alignmentType,r=e.colorScheme,o=e.positionsToStyle,i=e.sortBy,s=t.getSequences(i),l=t.getMaxSequenceLength(),c=s.length,u={fullWidth:l,fullHeight:c,targetTileWidth:Math.min(400,l),targetTileHeight:Math.min(400,c)},h=this.initializeTiledImages(u),d=0;d<h.numYTiles;d++)for(var p=0;p<h.numXTiles;p++){var m=this.generateCanvasForTile(p,d,u.targetTileWidth,u.targetTileHeight,h,s);h.tiles.push(m)}return a.a.createElement(a.a.Fragment,null,h.tiles.map((function(e){return a.a.createElement(Y.Sprite,{source:e.image,x:e.pixelX,y:e.pixelY,key:"".concat(e.tileX,"_\n                  ").concat(e.tileY,"_\n                  ").concat(r.commonName,"_\n                  ").concat(o.key,"_\n                  ").concat(n.key,"_\n                  ").concat(i.key,"_\n                  ").concat(t.getName())})})))}},{key:"colorCanvasWithSequence",value:function(e,t,n,r,a){for(var o=0,i=0;i<n.height;i++)for(var s=r[i+a.seqY],l=0;l<n.width;l++){var c=s.sequence[l+a.letterX],u=this.getCurrentMoleculeColors(c,l,a);e.data[o]=u.rgb.red,e.data[o+1]=u.rgb.green,e.data[o+2]=u.rgb.blue,e.data[o+3]=255,o+=4}t.putImageData(e,0,0)}},{key:"generateCanvasForTile",value:function(e,t,n,r,a,o){var i=document.createElement("canvas");i.height=t===a.numYTiles-1?a.lastTileHeight:r,i.width=e===a.numXTiles-1?a.lastTileWidth:n;var s={seqY:t*r,letterX:e*n},l=i.getContext("2d");null===l||void 0===l||l.fillRect(0,0,i.width,i.height);var c=null===l||void 0===l?void 0:l.getImageData(0,0,i.width,i.height);return c&&l&&this.colorCanvasWithSequence(c,l,i,o,s),{tileX:e,tileY:t,pixelX:s.letterX,pixelY:s.seqY,width:i.width,height:i.height,image:i}}},{key:"getCurrentMoleculeColors",value:function(e,t,n){var r=this.props,a=r.alignment,o=r.alignmentType,i=r.colorScheme,s=a.getConsensus(),l=a.getTargetSequence().sequence,c=o===w.AMINOACID?_:D,u=c.UNKNOWN;if(this.props.positionsToStyle===k.ALL)u=c.fromSingleLetterCode(e);else{var h=s[t+n.letterX].letter===e,d=l[t+n.letterX]===e;(this.props.positionsToStyle===k.CONSENSUS&&h||this.props.positionsToStyle===k.CONSENSUS_DIFF&&!h||this.props.positionsToStyle===k.QUERY&&d||this.props.positionsToStyle===k.QUERY_DIFF&&!d)&&(u=c.fromSingleLetterCode(e))}return u.colors[i.commonName]}},{key:"initializeTiledImages",value:function(e){var t=e.targetTileWidth,n=void 0===t?0:t,r=e.targetTileHeight,a=void 0===r?0:r,o=e.fullWidth,i=void 0===o?0:o,s=e.fullHeight,l=void 0===s?0:s;return{targetTileWidth:n,targetTileHeight:a,lastTileWidth:i%n!==0?i%n:n,lastTileHeight:l%a!==0?l%a:a,numXTiles:i%n!==0?Math.floor(i/n)+1:Math.floor(i/n),numYTiles:l%a!==0?Math.floor(l/a)+1:Math.floor(l/a),tiles:[]}}}]),t}(a.a.Component),$=Object(Y.PixiComponent)("PixiViewport",{create:function(e){var t=e.app,n=e.numColumns,r=e.numRows,a=e.useDrag,o=e.usePinch,i=e.useWheel,s=e.zoomPercent;t.renderer.backgroundColor=16777215;var l=new Q.a({screenWidth:t.renderer.width,screenHeight:t.renderer.height,worldWidth:n,worldHeight:r,interaction:t.renderer.plugins.interaction}).decelerate().clamp({direction:"all"}).bounce({friction:.1,time:150,underflow:"center"}).clampZoom({maxHeight:t.renderer.height,maxWidth:t.renderer.width});return a&&(l=l.drag({direction:"all"})),o&&(l=l.pinch()),i&&(l=l.wheel()),s&&(l=l.zoomPercent(s)),l.on("clicked",(function(t){e.mouseDown&&e.mouseDown(t.world.x,t.world.y)})),l},applyProps:function(e,t,n){return t.numColumns===n.numColumns&&t.numRows===n.numRows||(e.screenWidth=n.app.renderer.width,e.screenHeight=n.app.renderer.height,e.worldWidth=n.numColumns,e.worldHeight=n.numRows,e=(e=e.fitWorld(!0)).setZoom(n.app.renderer.width/n.numColumns,!1)),e}}),Z=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).renderCanvasComponent=function(){var e=n.props,t=e.alignment,a=e.highlightRows,o=e.sortBy,i=e.style,s=(e.width,n.state.zoomPercent),l=n.getSizing();return r.createElement("div",null,r.createElement(K,{id:"alignment_canvas",alignment:t,alignmentType:i.alignmentType,positionsToStyle:i.positionsToStyle,colorScheme:i.colorScheme,sortBy:o,stageResolution:{width:l.frameWidth,height:l.frameHeight},highlightRows:a,viewportProps:{useDrag:!0,usePinch:!0,useWheel:!0,zoomPercent:s},mouseDown:n.onMouseDown}))},n.onMouseDown=function(e,t){var r=n.props.onClick;r&&r(e,t)},n.state={zoomPercent:1},n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"getSizing",value:function(){return{borderWidth:1,margin:2,frameHeight:this.props.height-4-1,frameWidth:this.props.width-4-1}}},{key:"render",value:function(){var e=this.props,t=e.alignHorizontal,n=(e.width,this.getSizing());return r.createElement("div",{style:Object(c.a)({zIndex:1e5},"left"===t?{left:0}:{right:0},{top:0,bottom:0,height:n.frameHeight,width:n.frameWidth,position:"fixed",backgroundColor:"white",borderColor:"#333333",borderStyle:"solid",borderWidth:"".concat(n.borderWidth,"px"),margin:"".concat(n.margin,"px")})},this.renderCanvasComponent())}}]),t}(r.Component);Z.defaultProps={alignHorizontal:"right",height:600,width:300};var J=function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(a)))).editor=void 0,n.lastText=void 0,n.lastMode=void 0,n.element=void 0,n.lastElementWidth=void 0,n.lastElementHeight=void 0,n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"getText",value:function(){if(this.props.text)return this.props.text;throw Error("Internal error: 'text' attribute must be provided or subclasses must implement getText()")}},{key:"getEditorMode",value:function(){return this.props.editorMode}},{key:"setupEditorAndEventListeners",value:function(e){this.editor=v.a.edit(e),this.editor.setShowPrintMargin(!1),this.editor.setReadOnly(!0),this.editor.setHighlightActiveLine(!1),this.editor.setHighlightGutterLine(!1),this.editor.setFontSize(this.props.fontSize+"px"),this.editor.renderer.setShowGutter(!1),this.editor.renderer.setPadding(0),this.editor.renderer.$cursorLayer.element.style.display="none"}},{key:"addMouseEventListeners",value:function(){var e=this;if(!this.editor)throw Error("Editor must be defined before adding mouse listeners.");function t(e,t){var n=t.getDocumentPosition(),r=e.renderer.textToScreenCoordinates(n.row,n.column);return{mouseRow:n.row,mouseColumn:n.column,mousePageX:r.pageX,mousePageY:r.pageY}}return this.editor.on("mousemove",(function(n){e.props.mouseMove&&e.props.mouseMove(t(e.editor,n))})),this.editor.on("mousedown",(function(n){e.props.mouseDown&&e.props.mouseDown(t(e.editor,n))})),this.editor}},{key:"setText",value:function(){if(!this.editor)throw Error("Editor must be defined to call setText()");if(this.props.fontSize+"px"!==this.editor.getFontSize()&&(this.editor.setFontSize(this.props.fontSize+"px"),this.props.characterSizeChanged&&this.editor.renderer.characterWidth&&this.props.characterSizeChanged(this.editor.renderer.characterWidth)),this.lastMode!==this.getEditorMode()){var e=this.getEditorMode();this.editor.session.setMode(e),this.lastMode=e}if(!this.lastText||this.lastText!==this.getText()){this.editor.selectAll(),this.editor.removeLines();var t=this.getText();this.editor.insert(t),this.lastText=t}}},{key:"initialLoad",value:function(e){e&&!this.editor&&(this.element=e,this.lastElementWidth=e.clientWidth,this.lastElementHeight=e.clientHeight,this.setupEditorAndEventListeners(e),this.addMouseEventListeners(),this.setText(),this.props.editorLoaded&&this.props.editorLoaded(this.editor))}},{key:"componentDidUpdate",value:function(){if(!this.editor||!this.element)throw Error("internal error - componentDidUpdate called before editor initialized");return this.setText(),this.element.clientWidth===this.lastElementWidth&&this.element.clientHeight===this.lastElementHeight||(this.lastElementWidth=this.element.clientWidth,this.lastElementHeight=this.element.clientHeight,this.editor.resize()),!1}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:this.props.classNames,onMouseEnter:function(){e.props.mouseEnter&&e.props.mouseEnter()},onMouseLeave:function(){e.props.mouseLeave&&e.props.mouseLeave()}},a.a.createElement("div",{id:this.props.id,ref:function(t){return e.initialLoad(t)}}))}}]),t}(a.a.Component);J.defaultProps={fontSize:14};var ee=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(h.a)(t,[{key:"getText",value:function(){return this.props.alignment.getSequences(this.props.sortBy).map((function(e){return e.sequence})).join("\n")}},{key:"getEditorMode",value:function(){return this.props.alignment.getAceEditorMode()}}]),t}(J);ee.defaultProps={sortBy:H.INPUT,fontSize:14};var te=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(h.a)(t,[{key:"getText",value:function(){return this.props.alignment.getConsensus().map((function(e){return e.letter})).join("")}}]),t}(ee),ne=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(h.a)(t,[{key:"getText",value:function(){return this.props.alignment.getTargetSequence().sequence}}]),t}(ee),re=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(h.a)(t,[{key:"getText",value:function(){return t.generateTextualRuler(this.props.alignment.getMaxSequenceLength())}},{key:"getEditorMode",value:function(){}}],[{key:"generateTextualRuler",value:function(e){for(var t="",n=1;n<=e+1;n++){var r=n%10===0;if(t+=r?"|":!r&&n%5===0?":":".",r){var a=""+n,o=t.length-a.length-1;o<0||(t=t.substr(0,o)+a+"|")}}return t}}]),t}(J),ae={style:new M,logoPlotStyle:z.LETTERS,zoomLevel:13,sortBy:H.INPUT,showMiniMap:!1,showAnnotations:!0},oe=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).handleCharacterSizeChanged=function(e){n.state.aceCharacterWidth!==e&&n.setState({aceCharacterWidth:e})},n.aceEditorLoaded=function(e,t,r){var a=R.getInstance();r!==P.horizontal&&r!==P.both||a.registerScroller(t,"horizontal"),r!==P.vertical&&r!==P.both||a.registerScroller(t,"vertical"),n.setState({aceCharacterWidth:t.renderer.characterWidth,aceEditors:[t].concat(n.state.aceEditors)}),"ace-alignment"===e&&t.renderer.on("afterRender",(function(){setTimeout((function(){n.setState({alignmentEditorVisibleFirstRow:t.renderer.getFirstFullyVisibleRow(),alignmentEditorVisibleLastRow:t.renderer.getLastFullyVisibleRow()})}))}))},n.windowDimensionsUpdated=function(){n.setState({windowWidth:window.innerWidth,windowHeight:window.innerHeight})},n.renderSequenceLogo=function(){return a.a.createElement("div",{className:"logo_box ".concat(n.props.style.alignmentType.className," ")+"".concat(n.props.style.colorScheme.className," ")+"".concat(k.ALL.className)},a.a.createElement(I,{id:"sequence_logo",alignment:n.props.alignment,glyphWidth:n.state.aceCharacterWidth,logoType:n.props.logoPlotStyle}))},n.renderConservationBox=function(){return a.a.createElement(F,{id:"sequence_conservation",alignment:n.props.alignment,characterWidth:n.state.aceCharacterWidth})},n.renderConsensusQueryBox=function(){return a.a.createElement("div",{className:"consensusseq_box"},a.a.createElement(te,{id:"ace-consensusseq",alignment:n.props.alignment,fontSize:n.props.zoomLevel,classNames:[n.props.style.residueDetail.className,n.props.style.alignmentType.className,n.props.style.positionsToStyle.className,n.props.style.colorScheme.className].join(" "),editorLoaded:function(e){n.aceEditorLoaded("ace-consensusseq",e,P.horizontal)}}))},n.renderQuerySeqBox=function(){return a.a.createElement("div",{className:"queryseq_box"},a.a.createElement(ne,{id:"ace-queryseq",alignment:n.props.alignment,fontSize:n.props.zoomLevel,sortBy:n.props.sortBy,classNames:[n.props.style.residueDetail.className,n.props.style.alignmentType.className,n.props.style.positionsToStyle.className,n.props.style.colorScheme.className].join(" "),editorLoaded:function(e){n.aceEditorLoaded("ace-queryseq",e,P.horizontal)}}))},n.renderPositionBox=function(){return a.a.createElement("div",{className:"position_box"},a.a.createElement(re,{id:"ace-positions",alignment:n.props.alignment,fontSize:n.props.zoomLevel,editorLoaded:function(e){n.aceEditorLoaded("ace-positions",e,P.horizontal)},mouseEnter:function(){},mouseLeave:function(){},mouseMove:function(e){},mouseDown:function(e){}}))},n.renderAlignmentBox=function(){return a.a.createElement("div",{className:"alignment_box"},a.a.createElement(ee,{id:"ace-alignment",alignment:n.props.alignment,fontSize:n.props.zoomLevel,sortBy:n.props.sortBy,classNames:[n.props.style.residueDetail.className,n.props.style.alignmentType.className,n.props.style.positionsToStyle.className,n.props.style.colorScheme.className].join(" "),characterSizeChanged:n.handleCharacterSizeChanged,editorLoaded:function(e){n.aceEditorLoaded("ace-alignment",e,P.both)}}))},n.renderAlignmentAnnotationBox=function(){return a.a.createElement("div",{className:"alignment_metadata_box"},a.a.createElement(J,{id:"ace-alignment-metadata",text:n.props.alignment.getSequences(n.props.sortBy).map((function(e){return e.id})).join("\n"),fontSize:n.props.zoomLevel,editorLoaded:function(e){n.aceEditorLoaded("ace-alignment-metadata",e,P.vertical)}}))},n.onMinimapClick=function(e,t){var r=n.state,a=r.aceEditors,o=r.alignmentEditorVisibleFirstRow,i=r.alignmentEditorVisibleLastRow,s=40;void 0!==o&&void 0!==i&&(s=i-o),a.length>=1&&a[0].scrollToRow(Math.floor(t-s/2))},n.state={aceEditors:[],aceCharacterWidth:0,windowWidth:window.innerWidth,windowHeight:window.innerHeight},R.getInstance().setScrollerGroup("horizontal",P.horizontal),R.getInstance().setScrollerGroup("vertical",P.vertical),n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"generateWidget",value:function(e,t,n,r){return a.a.createElement("div",{className:"av-widget ".concat(e)},a.a.createElement("div",{className:"av-annotation"},t),a.a.createElement("div",{className:"av-content",ref:function(e){e&&r&&R.getInstance().registerScroller(e,"horizontal",!0)}},n))}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.windowDimensionsUpdated)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.windowDimensionsUpdated)}},{key:"render",value:function(){if(!this.props.alignment)return null;var e=this.props.showAnnotations?"":" annotation-closed";return a.a.createElement("div",{className:"alignment_viewer".concat(e)},this.renderMiniMap(),this.generateWidget("av-conservation-gaps","Conservation / gaps:",this.renderConservationBox(),!0),this.generateWidget("av-sequence-logo","Logo:",this.renderSequenceLogo(),!0),this.generateWidget("av-consensus-seq","Consensus sequence:",this.renderConsensusQueryBox()),this.generateWidget("av-target-seq","Query sequence:",this.renderQuerySeqBox()),this.generateWidget("av-position-indicator","Position:",this.renderPositionBox()),this.generateWidget("av-ace-msa",this.renderAlignmentAnnotationBox(),this.renderAlignmentBox()))}},{key:"renderMiniMap",value:function(){var e=this.props,t=e.alignment,n=e.sortBy,r=e.showMiniMap,o=e.style,i=this.state,s=(i.windowWidth,i.windowHeight),l=Math.max(300,Math.min(450,t.getMaxSequenceLength())),c=r?"mini-map":"mini-map hidden";return t&&o&&a.a.createElement("div",{className:c},a.a.createElement(Z,{width:l,height:s,alignHorizontal:"right",alignment:t,style:o,sortBy:n,highlightRows:void 0!==this.state.alignmentEditorVisibleFirstRow&&void 0!==this.state.alignmentEditorVisibleLastRow?[this.state.alignmentEditorVisibleFirstRow,this.state.alignmentEditorVisibleLastRow]:void 0,onClick:this.onMinimapClick}))}}]),t}(a.a.Component);oe.defaultProps=ae;var ie=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).fileInput=void 0,n.handleSubmit=n.handleSubmit.bind(Object(B.a)(n)),n.fileInput=r.createRef(),n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"handleSubmit",value:function(e){var t=this.props.onFileLoadCb;e.preventDefault(),t&&this.fileInput.current&&this.fileInput.current.files&&t(this.fileInput.current.files[0],e)}},{key:"render",value:function(){var e=this.props.labelText;return r.createElement("label",null,r.createElement("strong",null,e),r.createElement("input",{type:"file",ref:this.fileInput,onInput:this.handleSubmit}))}}]),t}(r.Component);ie.defaultProps={labelText:"Upload:"};var se=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props,t=e.fileURL,n=e.fileName,a=e.labelText,o=e.onStartLoading,i=e.onFileLoaded;return r.createElement("button",{type:"button",className:"button-link",onClick:function(e){var r;return l.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return o&&o(),e.t0=File,e.t1=l.a,e.next=5,l.a.awrap(fetch("".concat(t)));case 5:return e.t2=e.sent.blob(),e.next=8,e.t1.awrap.call(e.t1,e.t2);case 8:e.t3=e.sent,e.t4=[e.t3],e.t5=n,r=new e.t0(e.t4,e.t5),i(r);case 13:case"end":return e.stop()}}))}},a)}}]),t}(r.Component),le=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).renderSettingsBox=function(e){var t=n.state.alignment,r=t?a.a.createElement("div",null,a.a.createElement("h3",null,t.getName()),a.a.createElement("h4",null,"".concat(t.getSequences().length," sequences (rows) and ").concat(t.getMaxSequenceLength()," positions (columns) "))):a.a.createElement(a.a.Fragment,null);return a.a.createElement("div",{className:"settings_box"},a.a.createElement("form",null,a.a.createElement("div",{className:"settings-header"},a.a.createElement("button",{style:{display:n.state.showSettings?"none":"block"},type:"button",className:"button-link",onClick:function(e){n.setState({showSettings:!0})}},"Expand"),a.a.createElement("button",{style:{display:n.state.showSettings?"block":"none"},type:"button",className:"button-link",onClick:function(e){n.setState({showSettings:!1})}},"Hide"),a.a.createElement("div",null,a.a.createElement("h2",null,"AlignmentViewer 2.0 Settings Demo"),r)),a.a.createElement("div",{style:{display:n.state.showSettings?"block":"none",position:"relative"}},n.renderAlignmentTypeLabel(e),n.renderSortControl(),n.renderColorScheme(e),n.renderResidueDetail(e),n.renderPositionStyling(e),n.renderSequenceLogo(),n.renderZoomButtons(),n.renderMiniMapToggle(),n.renderAnnotationToggle(),a.a.createElement("br",null),n.renderFileUpload(),n.renderExampleLinks(),a.a.createElement("div",{className:"loader",style:{display:n.state.loading?"block":"none"}}))))},n.renderSortControl=function(){var e=n.state.sortBy;return a.a.createElement("div",null,a.a.createElement("label",null,a.a.createElement("strong",null,"Sort order:"),a.a.createElement("select",{value:e.key,onChange:function(e){return n.setState({sortBy:H.fromKey(e.target.value)})}},H.list.map((function(e){return a.a.createElement("option",{value:e.key,key:e.key},e.description)})))))},n.renderAlignmentTypeLabel=function(e){return a.a.createElement("div",null,a.a.createElement("label",null,a.a.createElement("strong",null,"Alignment Type:"),a.a.createElement("select",{value:e.alignmentType.key,onChange:function(e){return n.setState({style:T.fromAlignmentType(w.fromKey(e.target.value))})}},w.list.map((function(e){return a.a.createElement("option",{value:e.key,key:e.key},e.description)})))))},n.renderColorScheme=function(e){return a.a.createElement("div",null,a.a.createElement("label",null,a.a.createElement("strong",null,"Style:"),a.a.createElement("select",{value:e.alignmentType.allColorSchemes.indexOf(e.colorScheme),onChange:function(t){n.setState({style:Object(c.a)({},e,{colorScheme:e.alignmentType.allColorSchemes[parseInt(t.target.value)]})})}},e.alignmentType.allColorSchemes.map((function(e,t){return a.a.createElement("option",{key:t,value:t},e.description)})))))},n.renderResidueDetail=function(e){return a.a.createElement("div",null,a.a.createElement("label",null,a.a.createElement("strong",null,"Residue Detail:"),a.a.createElement("select",{value:e.residueDetail.key,onChange:function(t){n.setState({style:Object(c.a)({},e,{residueDetail:O.fromKey(t.target.value)})})}},O.list.map((function(e){return a.a.createElement("option",{key:e.key,value:e.key},e.description)})))))},n.renderPositionStyling=function(e){return a.a.createElement("div",null,a.a.createElement("label",null,a.a.createElement("strong",null,"Positions to Style:"),a.a.createElement("select",{value:k.list.indexOf(e.positionsToStyle),onChange:function(t){n.setState({style:Object(c.a)({},e,{positionsToStyle:k.list[parseInt(t.target.value)]})})}},k.list.map((function(e,t){return a.a.createElement("option",{key:t,value:t},e.description)})))))},n.renderSequenceLogo=function(){var e=n.state.logoPlotStyle;return a.a.createElement("div",null,a.a.createElement("label",null,a.a.createElement("strong",null,"Sequence Logo Style:"),a.a.createElement("select",{value:e,onChange:function(e){n.setState({logoPlotStyle:e.target.value})}},Object.values(z).map((function(e){return a.a.createElement("option",{key:e,value:e},e)})))))},n.renderZoomButtons=function(){var e=n.state.zoomLevel;return a.a.createElement("div",null,a.a.createElement("label",null,a.a.createElement("strong",null,"Character size:"),a.a.createElement("div",{className:"zoom-level"},a.a.createElement("button",{type:"button",disabled:e<3,onClick:function(t){n.setState({zoomLevel:e-1})}},"-"),e,a.a.createElement("button",{type:"button",disabled:e>15,onClick:function(t){n.setState({zoomLevel:e+1})}},"+"))))},n.renderFileUpload=function(){return a.a.createElement("div",null,a.a.createElement(ie,{labelText:"Upload Sequence File:",onFileLoadCb:n.onFileUpload}))},n.renderExampleLinks=function(){return a.a.createElement("div",{className:"examples"},a.a.createElement("label",null,a.a.createElement("strong",null,"Example Alignments:"),a.a.createElement(se,{labelText:"\u03b2-lactamase",fileURL:"".concat("/AlignmentViewer2.0","/7fa1c5691376beab198788a726917d48_b0.4.a2m"),fileName:"7fa1c5691376beab198788a726917d48_b0.4.a2m",onFileLoaded:n.onFileUpload,onStartLoading:function(){return n.setState({loading:!0})}})))},n.renderMiniMapToggle=function(){return a.a.createElement("div",{className:"minimap-toggle"},a.a.createElement("label",null,a.a.createElement("strong",null,"Show MiniMap:"),a.a.createElement("input",{name:"showMiniMap",type:"checkbox",checked:n.state.showMiniMap,onChange:function(e){var t=e.target;n.setState({showMiniMap:t.checked})}})))},n.renderAnnotationToggle=function(){return a.a.createElement("div",{className:"annotation-toggle"},a.a.createElement("label",null,a.a.createElement("strong",null,"Show Annotations:"),a.a.createElement("input",{name:"showAnnotations",type:"checkbox",checked:n.state.showAnnotations,onChange:function(e){var t=e.target;n.setState({showAnnotations:t.checked})}})))},n.onFileUpload=function(e){var t;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:n.setState({loading:!0}),(t=new FileReader).onload=function(r){var a=t.result,o=W.fromFileContents(e.name,a);n.setState({alignment:o,style:o.getPredictedType()===w.NUCLEOTIDE?new N:new M,loading:!1})},t.readAsText(e);case 4:case"end":return r.stop()}}))},n.state={style:new M,logoPlotStyle:z.LETTERS,zoomLevel:14,sortBy:H.INPUT,showMiniMap:!1,showAnnotations:!0,showSettings:!0},n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.state,t=e.alignment,n=e.logoPlotStyle,r=e.showAnnotations,o=e.showMiniMap,i=e.sortBy,s=e.style,l=e.zoomLevel,c=t?a.a.createElement("div",{className:"av_holder"},a.a.createElement(oe,{alignment:t,style:s,logoPlotStyle:n,zoomLevel:l,sortBy:i,showMiniMap:o,showAnnotations:r})):a.a.createElement(a.a.Fragment,null);return a.a.createElement("div",null,this.renderSettingsBox(s),c)}}]),t}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(le,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},7:function(e,t,n){e.exports={acePrefix:"ace_",preAceLetterObjClass:"obj",preAceQueryClass:"query",preAceConsensusClass:"consensus",aceLetterObjClass:"ace_obj",aceQueryClass:"ace_query",aceConsensusClass:"ace_consensus",transparentLetterClass:"transparent-letters",transparentBackgroundClass:"transparent-background",aaAlignTypeClass:"alignment-aa",ntAlignTypeClass:"alignment-nt",styPosAllClass:"alignment-positions-tostyle-all",styPosQueryClass:"alignment-positions-tostyle-query",styPosQueryDiffClass:"alignment-positions-tostyle-query-diff",styPosConsensusClass:"alignment-positions-tostyle-consensus",styPosConsensusDiffClass:"alignment-positions-tostyle-consensus-diff",aaStyClass_Default:"aa-alignment-style-default",aaStyDesc_Default:"Default",aaStyBGAlpha_Default:".25",aaStyColorOrder_Default:"A,R,N,D,C,Q,E,G,H,I,L,K,M,F,P,S,T,W,Y,V",aaStyColors_Default:"#3c0,#c00,#60c,#03f,#ff0,#60c,#03f,#3c0,#090,#3c0,#3c0,#c00,#3c0,#090,#3c0,#09f,#09f,#090,#090,#3c0",aaStyClass_Hydrophobicity:"aa-alignment-style-hydrophobicity",aaStyDesc_Hydrophobicity:"Hydrophobicity",aaStyBGAlpha_Hydrophobicity:".25",aaStyColorOrder_Hydrophobicity:"F,I,W,L,V,M,Y,C,A,T,H,G,S,Q,R,K,N,E,P,D",aaStyColors_Hydrophobicity:"red,red,#ff0606,#ff0606,#ff4c4c,#ff5252,#f77,#ffa5a5,#ffc0c0,#e1e1ff,#d0d0ff,#b6b6ff,#a5a5ff,#9595ff,#8787ff,#6969ff,#5959ff,#4f4fff,#1d1dff,blue",ntStyClass_Default:"nt-alignment-style-default",ntStyDesc_Default:"Default",ntStyBGAlpha_Default:".25",ntStyColorOrder_Default:"A,C,G,T,U,R,Y",ntStyColors_Default:"#5050ff,#e00000,#00c000,#e6e600,#c90,#2e8b57,#ff8c00"}}},[[29,1,2]]]);
//# sourceMappingURL=main.e50b6132.chunk.js.map