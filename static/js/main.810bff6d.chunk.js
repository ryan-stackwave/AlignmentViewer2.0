(this.webpackJsonpalignmentviewer2=this.webpackJsonpalignmentviewer2||[]).push([[0],{29:function(e,t,n){e.exports=n(48)},34:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var r,a=n(0),o=n.n(a),i=n(25),s=n.n(i),l=(n(34),n(13)),c=n.n(l),u=n(8),h=n(2),d=n(3),p=n(5),m=n(4),g=n(6),f=(n(36),n(11));!function(e){e[e.hamming=0]="hamming"}(r||(r={}));var y=function(){function e(t,n,r,a){Object(h.a)(this,e),this.key=t,this.description=n,this.isTargetSequenceDependent=r,this.distanceFn=a}return Object(d.a)(e,null,[{key:"fromKey",value:function(t){return e.list.find((function(e){return e.key===t}))}}]),e}();y.INPUT=new y("as-input","As input",!1),y.HAMMING_DIST_TARGET=new y("hamming-dist-to-target","Hamming distance to target sequence",!0,r.hamming),y.list=[y.INPUT,y.HAMMING_DIST_TARGET];var v,L=function(){function e(t,n){var r=this;Object(h.a)(this,e),this.name=void 0,this.sequences=void 0,this.targetSequence=void 0,this.positionalLetterCounts=new Map,this.globalAlphaLetterCounts={},this.allAlphaLettersSorted=void 0,this.consensus=[],this.name=t,this.sequences=new Map,this.sequences.set(y.INPUT,n),this.targetSequence=n[0];for(var a=new Date,o={},i=0;i<n.length;i++)for(var s=n[i].sequence,l=0;l<s.length;l++){var c=s[l].toUpperCase(),u=!!c.match(/[a-z]/i),d=l;o[c]=1;var p=this.positionalLetterCounts.get(d);p||(p={},this.positionalLetterCounts.set(d,p)),c in p===!1&&(p[c]=0),p[c]+=1,u&&(c in this.globalAlphaLetterCounts===!1&&(this.globalAlphaLetterCounts[c]=0),this.globalAlphaLetterCounts[c]+=1)}this.allAlphaLettersSorted=Object.keys(o).sort().reduce((function(e,t){return t.match(/[a-z]/i)&&e.push(t),e}),[]),this.consensus=Array.from(this.positionalLetterCounts).map((function(e){var t=Object(f.a)(e,2),n=t[0],a=t[1],o=r.allAlphaLettersSorted.reduce((function(e,t){return e in a===!1||a[e]<a[t]?t:e}));return{position:n,letter:o,occurrences:a[o]}})),console.log("done parsing alignment. took "+((new Date).getTime()-a.getTime())+"ms")}return Object(d.a)(e,null,[{key:"fromFileContents",value:function(t,n){for(var r=n.split(">"),a=[],o=0;o<r.length;o++){var i=r[o].split(/\r?\n/);if(i.length>1){var s={id:i[0],sequence:i.slice(1).join("")};a.push(s)}}return new e(t,a)}},{key:"getSequenceDistance",value:function(e,t,n){var a=e.sequence.length<t.sequence.length?e.sequence.length:t.sequence.length,o=0;if(n===r.hamming){for(var i=0;i<a;i++)e.sequence[i]!==t.sequence[i]&&(o+=1);return o}throw Error("Unable to determine sequence distance with distance function "+n)}},{key:"normalizeLetterCounts",value:function(e,t){var n=Object.keys(e).reduce((function(n,r){return t&&!t.includes(r)||(n+=e[r]),n}),0);return Object.keys(e).reduce((function(r,a){return t&&!t.includes(a)||(r[a]=e[a]/n),r}),{})}}]),Object(d.a)(e,[{key:"getName",value:function(){return this.name}},{key:"getConsensus",value:function(){return this.consensus}},{key:"getGapsPerColumn",value:function(){return Array.from(this.positionalLetterCounts).map((function(e){var t=Object(f.a)(e,2),n=(t[0],t[1]);return isNaN(n["-"])?0:n["-"]}))}},{key:"getGlobalAlphaLetterCounts",value:function(t,n){return t?e.normalizeLetterCounts(this.globalAlphaLetterCounts,n):this.globalAlphaLetterCounts}},{key:"getMaxSequenceLength",value:function(){return this.getSequences().reduce((function(e,t){return t.sequence.length>e&&(e=t.sequence.length),e}),-1)}},{key:"getPositionalLetterCounts",value:function(t,n){return t?Array.from(this.positionalLetterCounts).reduce((function(t,r){var a=Object(f.a)(r,2),o=a[0],i=a[1];return t.set(o,e.normalizeLetterCounts(i,n)),t}),new Map):this.positionalLetterCounts}},{key:"getSequences",value:function(e,t){if(e=e||y.INPUT,t=t||!1,!this.sequences.has(e)||t)switch(e){case y.INPUT:break;case y.HAMMING_DIST_TARGET:this.sequences.set(e,this.sortByDistanceToTargetSequence(y.HAMMING_DIST_TARGET.distanceFn));break;default:throw Error('The sortBy option provided "'.concat(e,'" is not implemented'))}return this.sequences.get(e)}},{key:"getSortedAlphaLetters",value:function(){return this.allAlphaLettersSorted}},{key:"getTargetSequence",value:function(){return this.targetSequence}},{key:"setTargetSequence",value:function(e){var t=this;if(void 0===this.getSequences().find((function(t){return t===e})))throw Error("target sequence does not exist in alignment");this.targetSequence=e,this.sequences.forEach((function(e,n){t.getSequences(n,!0)}))}},{key:"sortByDistanceToTargetSequence",value:function(t){var n=this,a=this.getSequences();switch(t){case r.hamming:return a.map((function(e){return e})).sort((function(t,a){return e.getSequenceDistance(n.targetSequence,t,r.hamming)-e.getSequenceDistance(n.targetSequence,a,r.hamming)}));default:throw Error('The distFn option provided "'.concat(t,'" is not implemented'))}}}]),e}();n(37);!function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal",e[e.both=2]="both"}(v||(v={}));var S=function(){function e(){Object(h.a)(this,e),this._groupScrollpropsHM={},this._lastScrollerOffsets=new Map,this._blockNextHorizontalScrollEvent=new Map,this._blockNextVerticalScrollEvent=new Map}return Object(d.a)(e,[{key:"_setScrollerLastOffsets",value:function(e){}},{key:"_getAceMaxScrollWidth",value:function(e){return e.renderer.$getLongestLine()+2*e.renderer.$padding-e.renderer.$size.scrollerWidth}},{key:"_handleScrollEvent",value:function(e,t,n,r){var a=this;this._blockNextHorizontalScrollEvent.get(e)||(this._setScrollerLastOffsets(e),this._groupScrollpropsHM[t].scrollers.forEach((function(t){t!==e&&("renderer"in t?r===v.horizontal&&t.session.getScrollLeft()!==n?(a._blockNextHorizontalScrollEvent.set(t,!0),t.session.setScrollLeft(n)):r===v.vertical&&t.session.getScrollTop()!==n&&(a._blockNextVerticalScrollEvent.set(t,!0),t.session.setScrollTop(n)):r===v.horizontal&&t.scrollLeft!==n?(a._blockNextHorizontalScrollEvent.set(t,!0),t.scrollLeft=n):r===v.vertical&&t.scrollTop!==n&&(a._blockNextVerticalScrollEvent.set(t,!0),t.scrollTop=n))})));this._blockNextHorizontalScrollEvent.set(e,!1)}},{key:"setScrollerGroup",value:function(e,t){this._groupScrollpropsHM[e]={scrolltype:t,scrollers:this._groupScrollpropsHM[e]?this._groupScrollpropsHM[e].scrollers:[]}}},{key:"registerScroller",value:function(e,t,n){var r=this,a=this._groupScrollpropsHM[t];if(!a)throw new Error('Error: attempt to register scroll sync on unknown group "'.concat(t,'"\n                    please register group first with setScrollerGroup'));if(a.scrollers.includes(e)){if(n)return;throw new Error('Error: attempt to re-add scroller to group "'.concat(t,'"'))}a.scrollers.push(e),this._setScrollerLastOffsets(e),"renderer"in e?(a.scrolltype!==v.both&&a.scrolltype!==v.horizontal||e.session.on("changeScrollLeft",(function(n){r._handleScrollEvent(e,t,Math.round(e.session.getScrollLeft()),v.horizontal)})),a.scrolltype!==v.both&&a.scrolltype!==v.vertical||e.session.on("changeScrollTop",(function(n){r._handleScrollEvent(e,t,Math.round(e.session.getScrollTop()),v.vertical)}))):e.onscroll=function(n){var o,i=n.target.scrollLeft!==(null===(o=r._lastScrollerOffsets.get(e))||void 0===o?void 0:o.lastLeft)?v.horizontal:v.vertical;a.scrolltype!==v.both&&a.scrolltype!==i||r._handleScrollEvent(e,t,n.target.scrollLeft,i)}}}],[{key:"getInstance",value:function(){return this.singleton||(this.singleton=new e),this.singleton}}]),e}();S.singleton=void 0;var E=n(16),b=n.n(E),C=n(7),k=n.n(C),w=T("aa"),O=T("nt");function T(e){return Object.keys(k.a).reduce((function(t,n){if(-1!==n.indexOf(e+"StyClass_")){var r=n.split(e+"StyClass_")[1],a=k.a[e+"StyColorOrder_"+r].split(", "),o=k.a[e+"StyColors_"+r].split(", "),i=k.a[e+"StyDesc_"+r];t.push({commonName:r,description:i,className:k.a[n],backgroundAlpha:parseFloat(k.a[e+"StyBGAlpha_"+r]),colors:Object.fromEntries(a.map((function(e,t){return[a[t],o[t]]})))})}return t}),[])}var A=function(){function e(t,n,r,a){Object(h.a)(this,e),this.key=t,this.description=n,this.className=r,this.allColorSchemes=a}return Object(d.a)(e,null,[{key:"fromKey",value:function(t){return e.list.find((function(e){return e.key===t}))}}]),e}();A.AMINOACID=new A("aminoacid-alignment","Amino Acid Sequences",k.a.aaAlignTypeClass,w),A.NUCLEOTIDE=new A("nucleotide-alignment","Nucleotide Sequences",k.a.ntAlignTypeClass,O),A.list=[A.AMINOACID,A.NUCLEOTIDE];var N=function(){function e(t,n,r){Object(h.a)(this,e),this.key=t,this.description=n,this.className=r}return Object(d.a)(e,null,[{key:"fromKey",value:function(t){return e.list.find((function(e){return e.key===t}))}}]),e}();N.ALL=new N("all","All",k.a.styPosAllClass),N.QUERY=new N("query","Same as Query",k.a.styPosQueryClass),N.QUERY_DIFF=new N("query-diff","Different from Query",k.a.styPosQueryDiffClass),N.CONSENSUS=new N("consensus","Same as Consensus",k.a.styPosConsensusClass),N.CONSENSUS_DIFF=new N("consensus-diff","Different from Consensus",k.a.styPosConsensusDiffClass),N.list=[N.ALL,N.QUERY,N.QUERY_DIFF,N.CONSENSUS,N.CONSENSUS_DIFF];var M=function(){function e(t,n,r){Object(h.a)(this,e),this.key=t,this.description=n,this.className=r}return Object(d.a)(e,null,[{key:"fromKey",value:function(t){return e.list.find((function(e){return e.key===t}))}}]),e}();M.BOTH=new M("both","Style Background and Letters",""),M.LETTER_ONLY=new M("letter-only","Only Style Letters",k.a.transparentBackgroundClass),M.BACKGROUND_ONLY=new M("background-only","Only Style Background",k.a.transparentLetterClass),M.list=[M.BOTH,M.LETTER_ONLY,M.BACKGROUND_ONLY];var _,j=function(){function e(){Object(h.a)(this,e),this.alignmentType=void 0,this.colorScheme=void 0,this.positionsToStyle=void 0,this.residueDetail=void 0}return Object(d.a)(e,null,[{key:"fromAlignmentType",value:function(e){return e===A.AMINOACID?new x:new q}}]),e}(),x=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N.ALL,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M.BOTH;Object(h.a)(this,e),this.colorScheme=t,this.positionsToStyle=n,this.residueDetail=r,this.allColorSchemes=w,this.alignmentType=A.AMINOACID},q=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N.ALL,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M.BOTH;Object(h.a)(this,e),this.colorScheme=t,this.positionsToStyle=n,this.residueDetail=r,this.allColorSchemes=O,this.alignmentType=A.NUCLEOTIDE},D=(k.a.transparentLetterClass,k.a.transparentBackgroundClass,k.a.acePrefix);function P(e,t){var n=e.split("/");if(3!==n.length||"ace"!==n[0]||"mode"!==n[1])throw Error("ace mode name must be of the form '/ace/mode/MODENAME'");var r=e.split("/")[2];b.a.define("ace/mode/"+r+"_highlight_rules",(function(e,n,r){var a=e("../lib/oop"),o=e("./text_highlight_rules").TextHighlightRules,i=function(){for(var e={},n=function(n){var r=0===n?"start":"pos"+n,a=n===t.getMaxSequenceLength()-1?"start":"pos"+(n+1);e[r]=[{token:function(e){return function(e,t,n){return e+(t?"."+k.a.preAceConsensusClass:"")+(n?"."+k.a.preAceQueryClass:"")}(e,e===t.getConsensus()[n].letter,e===t.getTargetSequence().sequence[n])},regex:".",next:a}]},r=0;r<t.getMaxSequenceLength();r++)n(r);this.$rules=e};a.inherits(i,o),n.AlignmentHighlightRules=i})),b.a.define("ace/mode/"+r,(function(e,t,n){var a=e("../lib/oop"),o=e("../mode/text").Mode,i=e("../tokenizer").Tokenizer,s=e("ace/mode/"+r+"_highlight_rules").AlignmentHighlightRules,l=function(){this.$tokenizer=new i((new s).getRules())};a.inherits(l,o),function(){}.call(l.prototype),t.Mode=l}))}!function(e){e[e.query=0]="query",e[e.consensus=1]="consensus",e[e.alignment=2]="alignment",e[e.alignment_metadata=3]="alignment_metadata",e[e.position=4]="position"}(_||(_={}));var z,I=function(e){function t(){var e,n;Object(h.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).editor=void 0,n}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(e){var t,n,r,a;this.props.fontSize+"px"!==(null===(t=this.editor)||void 0===t?void 0:t.getFontSize())&&(null===(n=this.editor)||void 0===n||n.setFontSize(this.props.fontSize+"px"),this.props.characterSizeChanged&&(null===(r=this.editor)||void 0===r?void 0:r.renderer.characterWidth)&&this.props.characterSizeChanged(null===(a=this.editor)||void 0===a?void 0:a.renderer.characterWidth));(this.props.alignment!==e.alignment||this.props.sortBy!==e.sortBy&&this.props.type===_.alignment)&&(this.editor.selectAll(),this.editor.removeLines(),this.insertDataIntoEditor())}},{key:"setupAndInsertAceEditor",value:function(e){var t=this;return this.editor=b.a.edit(e),this.editor.setShowPrintMargin(!1),this.editor.setReadOnly(!0),this.editor.setHighlightActiveLine(!1),this.editor.setHighlightGutterLine(!1),this.editor.setFontSize(this.props.fontSize+"px"),this.editor.renderer.setShowGutter(!1),this.editor.renderer.setPadding(0),this.editor.renderer.$cursorLayer.element.style.display="none",this.editor.on("mousemove",(function(e){if(t.editor){var n=e.getDocumentPosition(),r=t.editor.renderer.textToScreenCoordinates(n.row,n.column),a=t.editor.renderer.characterWidth,o=document.getElementById("column_mouseover");o&&(o.style.left=r.pageX-3-2+"px",o.style.width=a+6+"px",o.style.display="block"),t.setState({mouseRow:n.row,mouseColumn:n.column,mousePageX:r.pageX,mousePageY:r.pageY,mouseContainerX:a*n.column-t.editor.session.getScrollLeft(),characterWidth:a})}})),this.editor}},{key:"insertDataIntoEditor",value:function(){if(this.editor){if([_.query,_.alignment,_.consensus].includes(this.props.type)){var e="ace/mode/"+this.props.alignment.getName();P(e,this.props.alignment),this.editor.session.setMode(e)}if(this.props.type===_.query)this.editor.insert(this.props.alignment.getTargetSequence().sequence);else if(this.props.type===_.consensus)this.editor.insert(this.props.alignment.getConsensus().map((function(e){return e.letter})).join(""));else if(this.props.type===_.alignment)this.editor.insert(this.props.alignment.getSequences(this.props.sortBy).map((function(e){return e.sequence})).join("\n"));else if(this.props.type===_.alignment_metadata)this.editor.insert(this.props.alignment.getSequences(this.props.sortBy).map((function(e){return e.id})).join("\n"));else if(this.props.type===_.position){var n=this.props.alignment.getMaxSequenceLength();this.editor.insert(t.generateTextualRuler(n))}else this.editor.insert("invalid type passed to AceEditorComponent")}}},{key:"divLoaded",value:function(e){e&&!this.editor&&(this.setupAndInsertAceEditor(e),this.insertDataIntoEditor(),this.props.editorLoaded(this.editor))}},{key:"mouseExited",value:function(){var e=document.getElementById("column_mouseover");e&&(e.style.display="none"),this.setState({mouseContainerX:void 0})}},{key:"changeZoom",value:function(e){}},{key:"render",value:function(){var e=this;return this.state&&this.state.mouseContainerX,o.a.createElement("div",{className:this.props.topLevelClassNames,onMouseLeave:function(){return e.mouseExited()}},o.a.createElement("div",{id:this.props.id,ref:function(t){return e.divLoaded(t)}}),void 0)}}],[{key:"generateTextualRuler",value:function(e){for(var t="",n=1;n<=e+1;n++){var r=n%10===0;if(t+=r?"|":!r&&n%5===0?":":".",r){var a=""+n,o=t.length-a.length-1;o<0||(t=t.substr(0,o)+a+"|")}}return t}}]),t}(o.a.Component),B=function(){function e(){Object(h.a)(this,e),this.letterToGlyphHM={A:e.A,B:e.B,C:e.C,D:e.D,E:e.E,F:e.F,G:e.G,H:e.H,I:e.I,J:e.J,K:e.K,L:e.L,M:e.M,N:e.N,O:e.O,P:e.P,Q:e.Q,R:e.R,S:e.S,T:e.T,U:e.U,V:e.V,W:e.W,X:e.X,Y:e.Y,Z:e.Z}}return Object(d.a)(e,null,[{key:"glyphFromChar",value:function(t){return e.singleton||(e.singleton=new e),e.singleton.letterToGlyphHM[t]}}]),e}();B.singleton=void 0,B.A=function(e){return o.a.createElement("g",{key:e.key+"_g"},o.a.createElement("path",Object.assign({},e,{d:"M 0 100 L 33 0 L 66 0 L 100 100 L 75 100 L 66 75 L 33 75 L 25 100 L 0 100"})),o.a.createElement("path",{key:e.key+"_p2",transform:e.transform,fill:"#ffffff",d:"M 41 55 L 50 25 L 58 55 L 41 55"}))},B.B=function(e){return o.a.createElement("g",{key:e.key+"_g"},o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 80 0 C 105 0 105 50 80 50 C 105 50 105 100 80 100 L 00 100 L 0 0"})),o.a.createElement("path",{key:e.key+"_p2",transform:e.transform,d:"M 20 15 L 70 15 C 80 15 80 35 70 35 L 20 35 L 20 15",fill:"#ffffff"}),o.a.createElement("path",{key:e.key+"_p3",transform:e.transform,d:"M 20 65 L 70 65 C 80 65 80 85 70 85 L 20 85 L 20 65",fill:"#ffffff"}))},B.C=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 100 28 C 100 -13 0 -13 0 50 C 0 113 100 113 100 72 L 75 72 C 75 90 30 90 30 50 C 30 10 75 10 75 28 L 100 28"}))},B.D=function(e){return o.a.createElement("g",{key:e.key+"_g"},o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 60 0 C 110 0 110 100 60 100 L 0 100 L 0 0"})),o.a.createElement("path",{key:e.key+"_p2",transform:e.transform,fill:"#ffffff",d:"M 20 15 L 40 15 C 85 15 85 85 40 85 L 20 85 L 20 15"}))},B.E=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 100 0 L 100 20 L 20 20 L 20 40 L 90 40 L 90 60 L 20 60 L 20 80 L 100 80 L 100 100 L 0 100 L 0 0"}))},B.F=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 100 0 L 100 20 L 20 20 L 20 40 L 80 40 L 80 60 L 20 60 L 20 100 L 0 100 L 0 0"}))},B.G=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 100 28 C 100 -13 0 -13 0 50 C 0 113 100 113 100 72 L 100 48 L 55 48 L 55 72 L 75 72 C 75 90 30 90 30 50 C 30 10 75 5 75 28 L 100 28"}))},B.H=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 20 40 L 80 40 L 80 0 L 100 0 L 100 100 L 80 100 L 80 60 L 20 60 L 20 100 L 0 100 L 0 0"}))},B.I=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 40 0 L 60 0 L 60 100 L 40 100 L 40 0"}))},B.J=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 60 C 0 111 100 111 100 60 L 100 0 L 75 0 L 75 60 C 80 90 20 90 25 60"}))},B.K=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 20 40 L 75 0 L 100 0 L 50 50 L 100 100 L 75 100 L 30 65 L 20 75 L 20 100 L 0 100 L 0 0"}))},B.L=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 0 100 L 100 100 L 100 80 L 20 80 L 20 0 L 0 0"}))},B.M=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 50 35 L 80 0 L 100 0 L 100 100 L 80 100 L 80 30 L 50 65 L 20 30 L 20 100 L 0 100 L 0 0"}))},B.N=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 100 L 0 0 L 20 0 L 80 75 L 80 0 L 100 0 L 100 100 L 80 100 L 20 25 L 20 100 L 0 100"}))},B.O=function(e){return o.a.createElement("g",{key:e.key+"_g"},o.a.createElement("circle",Object.assign({cx:"50",cy:"50",r:"50"},e)),o.a.createElement("circle",{key:e.key+"_c2",transform:e.transform,cx:"50",cy:"50",r:"32",fill:"#ffffff"}))},B.P=function(e){return o.a.createElement("g",{key:e.key+"_g"},o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 80 0 C 105 0 105 50 80 50 L 20 50 L 20 100 L 0 100 L 0 0"})),o.a.createElement("path",{key:e.key+"_p2",transform:e.transform,fill:"#ffffff",d:"M 20 15 L 70 15 C 80 15 80 35 70 35 L 20 35 L 20 15"}))},B.Q=function(e){return o.a.createElement("g",{key:e.key+"_g"},o.a.createElement("circle",Object.assign({cx:"50",cy:"50",r:"50"},Object(u.a)({},e,{key:e.key+"_c1"}))),o.a.createElement("circle",{key:e.key+"_c2",transform:e.transform,cx:"50",cy:"50",r:"32",fill:"#ffffff"}),o.a.createElement("path",Object.assign({d:"M 85 100 L 55 70 L 70 55 L 100 85 L 85 100"},e)))},B.R=function(e){return o.a.createElement("g",{key:e.key+"_g"},o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 80 0 C 105 0 105 50 80 50 C 100 50 100 70 100 70 L 100 100 L 80 100 L 80 80 C 80 80 80 60 50 60 L 20 60 L 20 100 L 0 100 L 0 0"})),o.a.createElement("path",{key:e.key+"_p2",transform:e.transform,fill:"#ffffff",d:"M 20 15 L 70 15 C 80 15 80 35 70 35 L 20 35 L 20 15"}))},B.S=function(e){return e.stroke||(e.stroke=e.fill),e.strokeOpacity||(e.strokeOpacity=e.fillOpacity),o.a.createElement("path",Object.assign({fill:"#ffffff"},e,{strokeWidth:"18",d:"M92 26 A43 20 0 1 0 43 46 A42 23 0 1 1 9 68"}))},B.T=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 0 20 L 35 20 L 35 100 L 65 100 L 65 20 L 100 20 L 100 0 L 0 0"}))},B.U=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 0 60 C 0 111 100 111 100 60 L 100 0 L 75 0 L 75 60 C 80 90 20 90 25 60 L 25 0 L 0 0"}))},B.V=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 50 80 L 80 0 L 100 0 L 60 100 L 40 100 L 0 0"}))},B.W=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 30 70 L 50 30 L 70 70 L 80 0 L 100 0 L 90 100 L 70 100 L 50 65 L 30 100 L 10 100 L 0 0"}))},B.X=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 50 40 L 80 0 L 100 0 L 70 50 L 100 100 L 80 100 L 50 60 L 20 100 L 0 100 L 30 50 L 0 0"}))},B.Y=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 20 0 L 50 45 L 80 0 L 100 0 L 60 60 L 60 100 L 40 100 L 40 60 L 0 0"}))},B.Z=function(e){return o.a.createElement("path",Object.assign({},e,{d:"M 0 0 L 100 0 L 100 20 L 35 80 L 100 80 L 100 100 L 0 100 L 0 80 L 65 20 L 0 20 L 0 0"}))},function(e){e.LETTERS="letter stack",e.BARS="bar plot"}(z||(z={}));var R=function(e){function t(){var e,n;Object(h.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).scrollerDiv=void 0,n.loaded=!1,n}return Object(g.a)(t,e),Object(d.a)(t,[{key:"divLoaded",value:function(e){e&&!this.scrollerDiv&&(this.scrollerDiv=e,this.props.logoLoaded&&this.props.logoLoaded(this.scrollerDiv))}},{key:"shouldComponentUpdate",value:function(e){return!1===this.loaded||this.props.logoType!==e.logoType||this.props.glyphWidth!==e.glyphWidth||this.props.alignment!==e.alignment}},{key:"render",value:function(){var e=this;if(!this.props.alignment||!this.props.glyphWidth)return null;var t=this.props.alignment.getPositionalLetterCounts(),n=this.props.alignment.getSortedAlphaLetters(),r=[];t.forEach((function(e,t){var a=Object.keys(e).reduce((function(t,n){return t+=e[n]}),0),o=n.map((function(t){var n=0;return t in e&&(n=e[t]/a),n}));r.push(o)}));var a=n.map((function(e){return{letter:e,classNames:D+e}})),i=r.map((function(e,t){return e.map((function(e,t){return{frequency:e,letter:a[t]}})).filter((function(e){return 0!==e.frequency})).sort((function(e,t){return e.frequency>t.frequency?1:-1}))})),s=r.length*this.props.glyphWidth;this.loaded=!0;return o.a.createElement("div",{id:this.props.id,ref:function(t){return e.divLoaded(t)}},o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 ".concat(i.length," 100"),style:{width:s,height:100},xmlns:"http://www.w3.org/2000/svg"},i.map((function(t,n){return o.a.createElement("g",{transform:"translate(".concat(n,",0)"),key:"p_"+n},function(t){var n=100,r=2/i.length;return t.map((function(t,a){return n-=100*t.frequency,e.props.logoType===z.BARS?o.a.createElement("rect",{width:"100",height:"100",transform:"translate(0, ".concat(n,") scale(").concat(r,",").concat(t.frequency,")"),className:t.letter.classNames,key:"idxrect_".concat(a)}):B.glyphFromChar(t.letter.letter)({className:t.letter.classNames,transform:"translate(0, ".concat(n,") scale(").concat(r,",").concat(t.frequency,")"),key:"idxglyph_".concat(a)})}))}(t))}))))}}]),t}(o.a.Component),H=n(28),W=n(10),F=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).scrollerDiv=void 0,n.state={isHovered:!1},n.handleSvgHover=n.handleSvgHover.bind(Object(W.a)(n)),n}return Object(g.a)(t,e),Object(d.a)(t,[{key:"handleSvgHover",value:function(e){this.setState({isHovered:e})}},{key:"computeEntropy",value:function(e,t,n,r){return e.reduce((function(e,r){return r in t&&(e+=t[r]*Math.log(t[r]/n[r])),e}),0)}},{key:"createConservationCountGs",value:function(){var e=this,t=[],n=this.props.alignment.getSortedAlphaLetters(),r=this.props.alignment.getPositionalLetterCounts(!0,n),a=this.props.alignment.getGlobalAlphaLetterCounts(!0,n),i=Array.from(r).map((function(t){var r=Object(f.a)(t,2),o=(r[0],r[1]);return e.computeEntropy(n,o,a)})),s=Math.max.apply(Math,Object(H.a)(i));return i.map((function(e){return e/s*100})).forEach((function(e,n){t.push(o.a.createElement("g",{transform:"translate(".concat(n,",").concat(100-e,")"),key:n},o.a.createElement("rect",{width:.5,height:"".concat(e)})))})),t}},{key:"createGapCountGs",value:function(e){for(var t=[],n=this.props.alignment.getSequences().length,r=this.props.alignment.getGapsPerColumn(),a=0;a<e;a++){var i=r[a]/n*100;t.push(o.a.createElement("g",{transform:"translate(".concat(a+.5,",").concat(100-i,")"),key:a},o.a.createElement("rect",{width:.5,height:i})))}return t}},{key:"divLoaded",value:function(e){e&&!this.scrollerDiv&&(this.scrollerDiv=e,this.props.conservationPlotLoaded&&this.props.conservationPlotLoaded(this.scrollerDiv))}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this;if(!this.props.alignment||!this.props.characterWidth)return null;var t=this.props.alignment.getMaxSequenceLength(),n=this.props.characterWidth*t,r=this.state.isHovered?"conservation hovered":"conservation";return o.a.createElement("div",null,o.a.createElement("div",{style:{backgroundColor:"rgba(255,255,255,0.9)",border:"solid 1px black",position:"absolute",padding:"3px",top:0,right:0,color:"red",visibility:this.state.isHovered?"visible":"hidden",zIndex:1e3}},o.a.createElement("span",{style:{color:"#000000"}},"Entropy"),o.a.createElement("span",{style:{color:"#b7b7b7",paddingLeft:10}},"# Gaps")),o.a.createElement("div",{id:this.props.id,ref:function(t){return e.divLoaded(t)}},o.a.createElement("div",{className:"svg_container"},o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 ".concat(t," 100"),style:{width:n,height:100},className:r,xmlns:"http://www.w3.org/2000/svg",onMouseEnter:function(){return e.handleSvgHover(!0)},onMouseLeave:function(){return e.handleSvgHover(!1)}},o.a.createElement("g",{className:"gapCount"},this.createGapCountGs(t)),o.a.createElement("g",{className:"entropy"},this.createConservationCountGs())))))}}]),t}(o.a.Component);function U(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,r){return t+t+n+n+r+r}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(t)return{red:parseInt(t[1],16),green:parseInt(t[2],16),blue:parseInt(t[3],16)};throw new Error("Bad Hex")}var G=function(){function e(t,n,r){Object(h.a)(this,e),this.singleLetterCode=t,this.threeLetterCode=n,this.fullName=r,this.glyph=void 0,this.colors=void 0,this.singleLetterCode=t,this.threeLetterCode=n,this.fullName=r,this.glyph=B.glyphFromChar(t),this.colors=w.reduce((function(e,n){var r=Object.entries(n.colors).find((function(e){var n=Object(f.a)(e,2),r=n[0];n[1];return r===t})),a="#ffffff";return r&&(a=r[1]),e[n.commonName]={hexString:a,rgb:U(a),backgroundAlpha:n.backgroundAlpha},e}),{})}return Object(d.a)(e,null,[{key:"fromSingleLetterCode",value:function(t){return t in this.bySingleLetterCode?e.bySingleLetterCode[t]:e.UNKNOWN}},{key:"fromThreeLetterCode",value:function(t){return t in this.byThreeLetterCode?e.byThreeLetterCode[t]:e.UNKNOWN}}]),e}();G.canonicalAminoAcids=[new G("A","ALA","Alanine"),new G("R","ARG","Arginine"),new G("N","ASN","Asparagine"),new G("D","ASP","Aspartic Acid"),new G("C","CYS","Cysteine"),new G("Q","GLU","Glutamine"),new G("E","GLN","Glutamic Acid"),new G("G","GLY","Glycine"),new G("H","HIS","Histidine"),new G("I","ILE","Isoleucine"),new G("L","LEU","Leucine"),new G("K","LYS","Lysine"),new G("M","MET","Methionine"),new G("F","PHE","Phenylalanine"),new G("P","PRO","Proline"),new G("S","SER","Serine"),new G("T","THR","Threonine"),new G("W","TRP","Tryptophan"),new G("Y","TYR","Tyrosine"),new G("V","VAL","Valine"),new G("X","UKN","Unknown Amino Acid")],G.bySingleLetterCode=G.canonicalAminoAcids.reduce((function(e,t){return e[t.singleLetterCode]=t,e}),{}),G.byThreeLetterCode=G.canonicalAminoAcids.reduce((function(e,t){return e[t.threeLetterCode]=t,e}),{}),G.UNKNOWN=G.bySingleLetterCode.X;var Y=function(){function e(t,n){Object(h.a)(this,e),this.singleLetterCode=t,this.fullName=n,this.glyph=void 0,this.colors=void 0,this.singleLetterCode=t,this.fullName=n,this.glyph=B.glyphFromChar(t),this.colors=O.reduce((function(e,n){var r=Object.entries(n.colors).find((function(e){var n=Object(f.a)(e,2),r=n[0];n[1];return r===t})),a="#ffffff";return r&&(a=r[1]),e[n.commonName]={hexString:a,rgb:U(a),backgroundAlpha:n.backgroundAlpha},e}),{})}return Object(d.a)(e,null,[{key:"fromSingleLetterCode",value:function(t){return t in this.bySingleLetterCode?e.bySingleLetterCode[t]:e.UNKNOWN}}]),e}();Y.allNucleotides=[new Y("A","Adenine"),new Y("C","Cytosine"),new Y("G","Guanine"),new Y("T","Thymidine"),new Y("U","Uracil"),new Y("R","Purine"),new Y("Y","Pyrimidine"),new Y("X","Unknown Nucleotide")],Y.bySingleLetterCode=Y.allNucleotides.reduce((function(e,t){return e[t.singleLetterCode]=t,e}),{}),Y.UNKNOWN=Y.bySingleLetterCode.X;var Q=n(1),X=n(14),K=n(27),V=Object(X.PixiComponent)("AlignmentHighlighter",{create:function(e){return new Q.Graphics},applyProps:function(e,t,n){var r=n.x,a=n.y,o=n.width,i=n.height,s=n.fillColor,l=n.fillAlpha;e.clear(),e.beginFill(s,l),e.drawRect(r,a,o,i),e.endFill()}}),Z=function(e){function t(){var e,n;Object(h.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).app=void 0,n.scaleX=1,n.scaleY=1,n.renderAlignmentHighlighter=function(e){return o.a.createElement(V,Object(u.a)({fillColor:16711680,fillAlpha:.25},e))},n.onMouseEnter=function(e){document.body.style.overflow="hidden"},n.onMouseLeave=function(e){document.body.style.overflow="auto"},n.onWheel=function(e){},n}return Object(g.a)(t,e),Object(d.a)(t,[{key:"sliderChanged",value:function(e,t){this.app&&this.app.stage.children.forEach((function(n){"x"===t?n.scale.x=e:n.scale.y=e}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.alignment,r=t.alignmentType,a=t.colorScheme,i=t.highlightRows,s=t.id,l=t.positionsToStyle,c=t.sortBy,u=t.stageResolution,h=t.viewportProps;if(!n)return null;var d=n.getSequences().length,p=n.getMaxSequenceLength();Q.settings.SCALE_MODE=Q.SCALE_MODES.NEAREST;var m=i?i[1]-i[0]:void 0;return o.a.createElement("div",{id:s,onWheel:this.onWheel,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},o.a.createElement(X.Stage,{width:null===u||void 0===u?void 0:u.width,height:null===u||void 0===u?void 0:u.height,options:{transparent:!0}},o.a.createElement(X.AppContext.Consumer,null,(function(t){return e.app=t,o.a.createElement(o.a.Fragment,null)})),o.a.createElement(X.AppContext.Consumer,null,(function(t){return o.a.createElement(ee,Object.assign({app:t,numColumns:p,numRows:d,mouseDown:e.props.mouseDown},h),o.a.createElement(J,{id:"tiled-alignment",alignment:n,alignmentType:r,sortBy:c,colorScheme:a,positionsToStyle:l}),m?o.a.createElement(o.a.Fragment,null,e.renderAlignmentHighlighter({x:0,y:e.props.highlightRows[0],width:p,height:m})):o.a.createElement(o.a.Fragment,null))}))))}}]),t}(o.a.Component);Z.defaultProps={mouseDown:function(){},stageResolution:{width:485,height:650},viewportProps:{useDrag:!0,usePinch:!0,useWheel:!0,zoomPercent:0}};var $,J=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(d.a)(t,[{key:"shouldComponentUpdate",value:function(e){return e.alignment!==this.props.alignment||e.colorScheme!==this.props.colorScheme||e.positionsToStyle!==this.props.positionsToStyle||e.sortBy!==this.props.sortBy}},{key:"render",value:function(){if(!this.props.alignment)return null;for(var e=this.props,t=e.alignment,n=e.alignmentType,r=e.colorScheme,a=e.positionsToStyle,i=e.sortBy,s=t.getSequences(i),l=t.getMaxSequenceLength(),c=s.length,u={fullWidth:l,fullHeight:c,targetTileWidth:Math.min(400,l),targetTileHeight:Math.min(400,c)},h=this.initializeTiledImages(u),d=0;d<h.numYTiles;d++)for(var p=0;p<h.numXTiles;p++){var m=this.generateCanvasForTile(p,d,u.targetTileWidth,u.targetTileHeight,h,s);h.tiles.push(m)}return console.log("CANVAS rerender ["+i.key+"]",s),o.a.createElement(o.a.Fragment,null,h.tiles.map((function(e){return o.a.createElement(X.Sprite,{source:e.image,x:e.pixelX,y:e.pixelY,key:"".concat(e.tileX,"_\n                  ").concat(e.tileY,"_\n                  ").concat(r.commonName,"_\n                  ").concat(a.key,"_\n                  ").concat(n.key,"_\n                  ").concat(i.key,"_\n                  ").concat(t.getName())})})))}},{key:"colorCanvasWithSequence",value:function(e,t,n,r,a){for(var o=0,i=0;i<n.height;i++)for(var s=r[i+a.seqY],l=0;l<n.width;l++){var c=s.sequence[l+a.letterX],u=this.getCurrentMoleculeColors(c,l,a);e.data[o]=u.rgb.red,e.data[o+1]=u.rgb.green,e.data[o+2]=u.rgb.blue,e.data[o+3]=255,o+=4}t.putImageData(e,0,0)}},{key:"generateCanvasForTile",value:function(e,t,n,r,a,o){var i=document.createElement("canvas");i.height=t===a.numYTiles-1?a.lastTileHeight:r,i.width=e===a.numXTiles-1?a.lastTileWidth:n;var s={seqY:t*r,letterX:e*n},l=i.getContext("2d");null===l||void 0===l||l.fillRect(0,0,i.width,i.height);var c=null===l||void 0===l?void 0:l.getImageData(0,0,i.width,i.height);return c&&l&&this.colorCanvasWithSequence(c,l,i,o,s),{tileX:e,tileY:t,pixelX:s.letterX,pixelY:s.seqY,width:i.width,height:i.height,image:i}}},{key:"getCurrentMoleculeColors",value:function(e,t,n){var r=this.props,a=r.alignment,o=r.alignmentType,i=r.colorScheme,s=a.getConsensus(),l=a.getTargetSequence().sequence,c=o===A.AMINOACID?G:Y,u=c.UNKNOWN;if(this.props.positionsToStyle===N.ALL)u=c.fromSingleLetterCode(e);else{var h=s[t+n.letterX].letter===e,d=l[t+n.letterX]===e;(this.props.positionsToStyle===N.CONSENSUS&&h||this.props.positionsToStyle===N.CONSENSUS_DIFF&&!h||this.props.positionsToStyle===N.QUERY&&d||this.props.positionsToStyle===N.QUERY_DIFF&&!d)&&(u=c.fromSingleLetterCode(e))}return u.colors[i.commonName]}},{key:"initializeTiledImages",value:function(e){var t=e.targetTileWidth,n=void 0===t?0:t,r=e.targetTileHeight,a=void 0===r?0:r,o=e.fullWidth,i=void 0===o?0:o,s=e.fullHeight,l=void 0===s?0:s;return{targetTileWidth:n,targetTileHeight:a,lastTileWidth:i%n!==0?i%n:n,lastTileHeight:l%a!==0?l%a:a,numXTiles:i%n!==0?Math.floor(i/n)+1:Math.floor(i/n),numYTiles:l%a!==0?Math.floor(l/a)+1:Math.floor(l/a),tiles:[]}}}]),t}(o.a.Component),ee=Object(X.PixiComponent)("PixiViewport",{create:function(e){var t=e.app,n=e.numColumns,r=e.numRows,a=e.useDrag,o=e.usePinch,i=e.useWheel,s=e.zoomPercent;t.renderer.backgroundColor=16777215;var l=new K.a({screenWidth:t.renderer.width,screenHeight:t.renderer.height,worldWidth:Math.max(n,t.renderer.width)+1,worldHeight:r,interaction:t.renderer.plugins.interaction}).decelerate().clamp({direction:"all"}).bounce({friction:.1,time:150,underflow:"center"}).clampZoom({maxHeight:t.renderer.height,maxWidth:t.renderer.width});return a&&(l=l.drag({direction:"all"})),o&&(l=l.pinch()),i&&(l=l.wheel()),console.log(s),s&&(l=l.zoomPercent(s)),l.on("clicked",(function(t){e.mouseDown&&e.mouseDown(t.world.x,t.world.y)})),$=l,l},applyProps:function(e,t,n){return t.zoomPercent!==n.zoomPercent&&n.zoomPercent&&($=$.setZoom(n.zoomPercent,!1)),$}}),te=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).renderCanvasComponent=function(){var e=n.props,t=e.alignment,r=e.height,o=e.highlightRows,i=e.sortBy,s=e.style,l=e.width,c=n.state.zoomPercent;return a.createElement("div",{style:{opacity:.75}},a.createElement(Z,{id:"alignment_canvas",alignment:t,alignmentType:s.alignmentType,positionsToStyle:s.positionsToStyle,colorScheme:s.colorScheme,sortBy:i,stageResolution:{width:l,height:r},highlightRows:o,viewportProps:{useDrag:!0,usePinch:!0,useWheel:!0,zoomPercent:c},mouseDown:n.onMouseDown}))},n.renderZoomControls=function(){return a.createElement("div",{style:{textAlign:"center",opacity:1}},a.createElement("button",{onClick:n.onZoomOut},"-"),a.createElement("button",{onClick:n.onZoomReset},"Reset"),a.createElement("button",{onClick:n.onZoomIn},"+"))},n.onMouseDown=function(e,t){var r=n.props.onClick;r&&r(e,t)},n.onZoomIn=function(){var e=n.state.zoomPercent;n.setState({zoomPercent:Math.min(8,e+.25)})},n.onZoomOut=function(){var e=n.state.zoomPercent;n.setState({zoomPercent:Math.max(.25,e-.25)})},n.onZoomReset=function(){n.setState({zoomPercent:1})},n.state={zoomPercent:1},n}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.alignHorizontal,n=(e.alignVertical,e.height),r=e.width;return a.createElement("div",{style:Object(u.a)({zIndex:1e5},"left"===t?{left:0}:{right:0},{top:0,bottom:0,height:n,position:"fixed",width:r})},this.renderCanvasComponent(),this.renderZoomControls())}}]),t}(a.Component);te.defaultProps={alignHorizontal:"right",alignVertical:"top",height:600,width:300};var ne=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e)))._handleCharacterSizeChanged=function(e){n.setState({aceCharacterWidth:e})},n._aceEditorLoaded=function(e,t,r){var a=S.getInstance();r!==v.horizontal&&r!==v.both||a.registerScroller(t,"horizontal"),r!==v.vertical&&r!==v.both||a.registerScroller(t,"vertical"),n.setState({aceCharacterWidth:t.renderer.characterWidth,aceEditors:[t].concat(n.state.aceEditors)}),"ace-alignment"===e&&t.renderer.on("afterRender",(function(){setTimeout((function(){n.setState({alignmentEditorFirstRow:t.renderer.getFirstFullyVisibleRow(),alignmentEditorLastRow:t.renderer.getLastFullyVisibleRow()})}))}))},n.renderSequenceLogo=function(){return o.a.createElement("div",{className:"logo_box ".concat(n.props.style.alignmentType.className," ")+"".concat(n.props.style.colorScheme.className," ")+"".concat(N.ALL.className)},o.a.createElement(R,{id:"sequence_logo",alignment:n.props.alignment,glyphWidth:n.state.aceCharacterWidth,logoType:n.props.logoPlotStyle}))},n.renderConservationBox=function(){return o.a.createElement(F,{id:"sequence_conservation",alignment:n.props.alignment,characterWidth:n.state.aceCharacterWidth})},n.renderConsensusQueryBox=function(){return o.a.createElement("div",{className:"consensusseq_box"},o.a.createElement(I,{id:"ace-consensusseq",type:_.consensus,alignment:n.props.alignment,fontSize:n.props.zoomLevel,sortBy:n.props.sortBy,topLevelClassNames:[n.props.style.residueDetail.className,n.props.style.alignmentType.className,n.props.style.positionsToStyle.className,n.props.style.colorScheme.className].join(" "),editorLoaded:function(e){n._aceEditorLoaded("ace-consensusseq",e,v.horizontal)}}))},n.renderQuerySeqBox=function(){return o.a.createElement("div",{className:"queryseq_box"},o.a.createElement(I,{id:"ace-queryseq",type:_.query,alignment:n.props.alignment,fontSize:n.props.zoomLevel,sortBy:n.props.sortBy,topLevelClassNames:[n.props.style.residueDetail.className,n.props.style.alignmentType.className,n.props.style.positionsToStyle.className,n.props.style.colorScheme.className].join(" "),editorLoaded:function(e){n._aceEditorLoaded("ace-queryseq",e,v.horizontal)}}))},n.renderPositionBox=function(){return o.a.createElement("div",{className:"position_box"},o.a.createElement(I,{id:"ace-positions",type:_.position,alignment:n.props.alignment,fontSize:n.props.zoomLevel,sortBy:n.props.sortBy,editorLoaded:function(e){n._aceEditorLoaded("ace-positions",e,v.horizontal)}}))},n.renderAlignmentBox=function(){return o.a.createElement("div",{className:"alignment_box"},o.a.createElement(I,{id:"ace-alignment",type:_.alignment,alignment:n.props.alignment,fontSize:n.props.zoomLevel,sortBy:n.props.sortBy,topLevelClassNames:[n.props.style.residueDetail.className,n.props.style.alignmentType.className,n.props.style.positionsToStyle.className,n.props.style.colorScheme.className].join(" "),characterSizeChanged:n._handleCharacterSizeChanged,editorLoaded:function(e){n._aceEditorLoaded("ace-alignment",e,v.both)}}))},n.renderAlignmentAnnotationBox=function(){return o.a.createElement("div",{className:"alignment_metadata_box"},o.a.createElement(I,{id:"ace-alignment-metadata",type:_.alignment_metadata,alignment:n.props.alignment,fontSize:n.props.zoomLevel,sortBy:n.props.sortBy,characterSizeChanged:n._handleCharacterSizeChanged,editorLoaded:function(e){n._aceEditorLoaded("ace-alignment-metadata",e,v.vertical)}}))},n.onMinimapClick=function(e,t){var r=n.state,a=r.aceEditors,o=r.alignmentEditorFirstRow,i=r.alignmentEditorLastRow,s=40;o&&i&&(s=i-o),a.length>=1&&a[0].scrollToRow(Math.floor(t-s/2))},n.state={aceEditors:[],aceCharacterWidth:0},S.getInstance().setScrollerGroup("horizontal",v.horizontal),S.getInstance().setScrollerGroup("vertical",v.vertical),n}return Object(g.a)(t,e),Object(d.a)(t,[{key:"_elementLoaded",value:function(e,t){S.getInstance().registerScroller(t,"horizontal",!0)}},{key:"generateWidget",value:function(e,t,n,r){var a=this;return o.a.createElement("div",{className:"av-widget ".concat(e)},o.a.createElement("div",{className:"av-annotation"},t),o.a.createElement("div",{className:"av-content",ref:function(t){t&&r&&a._elementLoaded(e,t)}},n))}},{key:"render",value:function(){var e=this.props.showAnnotations?"":" annotation-closed";return this.props.alignment?o.a.createElement("div",{className:"alignment_viewer".concat(e)},this.renderMiniMap(),this.generateWidget("av-conservation-gaps","Conservation / gaps:",this.renderConservationBox(),!0),this.generateWidget("av-sequence-logo","Logo:",this.renderSequenceLogo(),!0),this.generateWidget("av-consensus-seq","Consensus sequence:",this.renderConsensusQueryBox()),this.generateWidget("av-target-seq","Query sequence:",this.renderQuerySeqBox()),this.generateWidget("av-position-indicator","Position:",this.renderPositionBox()),this.generateWidget("av-ace-msa",this.renderAlignmentAnnotationBox(),this.renderAlignmentBox())):null}},{key:"renderMiniMap",value:function(){var e=this.props,t=e.alignment,n=e.sortBy,r=e.style,a=e.showMiniMap?"mini-map":"mini-map hidden";return t&&r&&o.a.createElement("div",{className:a},o.a.createElement(te,{width:t.getMaxSequenceLength(),height:window.innerHeight,alignHorizontal:"right",alignment:t,style:r,sortBy:n,highlightRows:void 0!==this.state.alignmentEditorFirstRow&&void 0!==this.state.alignmentEditorLastRow?[this.state.alignmentEditorFirstRow,this.state.alignmentEditorLastRow]:void 0,onClick:this.onMinimapClick}))}}]),t}(o.a.Component),re=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).fileInput=void 0,n.handleSubmit=n.handleSubmit.bind(Object(W.a)(n)),n.fileInput=a.createRef(),n}return Object(g.a)(t,e),Object(d.a)(t,[{key:"handleSubmit",value:function(e){var t=this.props.onFileLoadCb;e.preventDefault(),t&&this.fileInput.current&&this.fileInput.current.files&&t(this.fileInput.current.files[0],e)}},{key:"render",value:function(){var e=this.props.labelText;return a.createElement("label",null,a.createElement("strong",null,e),a.createElement("input",{type:"file",ref:this.fileInput,onInput:this.handleSubmit}))}}]),t}(a.Component);re.defaultProps={labelText:"Upload:"};var ae=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).renderSettingsBox=function(e){var t=n.state.alignment,r=t?o.a.createElement("h3",null,t.getName()):o.a.createElement(o.a.Fragment,null);return o.a.createElement("div",{className:"settings_box"},o.a.createElement("form",null,o.a.createElement("div",{className:"settings-header"},o.a.createElement("button",{style:{display:n.state.showSettings?"none":"block"},type:"button",className:"button-link",onClick:function(e){n.setState({showSettings:!0})}},"Expand"),o.a.createElement("button",{style:{display:n.state.showSettings?"block":"none"},type:"button",className:"button-link",onClick:function(e){n.setState({showSettings:!1})}},"Hide"),o.a.createElement("div",null,o.a.createElement("h2",null,"AlignmentViewer 2.0 Settings Demo"),r)),o.a.createElement("div",{style:{display:n.state.showSettings?"block":"none"}},n.renderAlignmentTypeLabel(e),n.renderSortControl(),n.renderColorScheme(e),n.renderResidueDetail(e),n.renderPositionStyling(e),n.renderSequenceLogo(),n.renderZoomButtons(),n.renderMiniMapToggle(),n.renderAnnotationToggle(),o.a.createElement("br",null),n.renderFileUpload(),n.renderExampleLinks())))},n.renderSortControl=function(){var e=n.state.sortBy;return o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("strong",null,"Sort order:"),o.a.createElement("select",{value:e.key,onChange:function(e){return n.setState({sortBy:y.fromKey(e.target.value)})}},y.list.map((function(e){return o.a.createElement("option",{value:e.key,key:e.key},e.description)})))))},n.renderAlignmentTypeLabel=function(e){return o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("strong",null,"Alignment Type:"),o.a.createElement("select",{value:e.alignmentType.key,onChange:function(e){return n.setState({style:j.fromAlignmentType(A.fromKey(e.target.value))})}},A.list.map((function(e){return o.a.createElement("option",{value:e.key,key:e.key},e.description)})))))},n.renderColorScheme=function(e){return o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("strong",null,"Style:"),o.a.createElement("select",{value:e.alignmentType.allColorSchemes.indexOf(e.colorScheme),onChange:function(t){n.setState({style:Object(u.a)({},e,{colorScheme:e.alignmentType.allColorSchemes[parseInt(t.target.value)]})})}},e.alignmentType.allColorSchemes.map((function(e,t){return o.a.createElement("option",{key:t,value:t},e.description)})))))},n.renderResidueDetail=function(e){return o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("strong",null,"Residue Detail:"),o.a.createElement("select",{value:e.residueDetail.key,onChange:function(t){n.setState({style:Object(u.a)({},e,{residueDetail:M.fromKey(t.target.value)})})}},M.list.map((function(e){return o.a.createElement("option",{key:e.key,value:e.key},e.description)})))))},n.renderPositionStyling=function(e){return o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("strong",null,"Positions to Style:"),o.a.createElement("select",{value:N.list.indexOf(e.positionsToStyle),onChange:function(t){n.setState({style:Object(u.a)({},e,{positionsToStyle:N.list[parseInt(t.target.value)]})})}},N.list.map((function(e,t){return o.a.createElement("option",{key:t,value:t},e.description)})))))},n.renderSequenceLogo=function(){var e=n.state.logoPlotStyle;return o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("strong",null,"Sequence Logo Style:"),o.a.createElement("select",{value:e,onChange:function(e){n.setState({logoPlotStyle:e.target.value})}},Object.values(z).map((function(e){return o.a.createElement("option",{key:e,value:e},e)})))))},n.renderZoomButtons=function(){var e=n.state.zoomLevel;return o.a.createElement("div",null,o.a.createElement("label",null,o.a.createElement("strong",null,"Character size:"),o.a.createElement("div",{className:"zoom-level"},o.a.createElement("button",{type:"button",disabled:e<3,onClick:function(t){n.setState({zoomLevel:e-1})}},"-"),e,o.a.createElement("button",{type:"button",disabled:e>15,onClick:function(t){n.setState({zoomLevel:e+1})}},"+"))))},n.renderFileUpload=function(){return o.a.createElement("div",null,o.a.createElement(re,{labelText:"Upload Sequence File:",onFileLoadCb:n.onFileUpload}))},n.renderExampleLinks=function(){return o.a.createElement("div",{className:"examples"},o.a.createElement("label",null,o.a.createElement("strong",null,"Example Alignments:"),o.a.createElement("button",{type:"button",className:"button-link",onClick:function(e){var t;return c.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=File,e.t1=c.a,e.next=4,c.a.awrap(fetch("".concat("/AlignmentViewer2.0","/7fa1c5691376beab198788a726917d48_b0.4.a2m")));case 4:return e.t2=e.sent.blob(),e.next=7,e.t1.awrap.call(e.t1,e.t2);case 7:e.t3=e.sent,e.t4=[e.t3],t=new e.t0(e.t4,"beta_lactamase_example.fasta"),n.onFileUpload(t);case 11:case"end":return e.stop()}}))}},"\u03b2-lactamase")))},n.renderMiniMapToggle=function(){return o.a.createElement("div",{className:"minimap-toggle"},o.a.createElement("label",null,o.a.createElement("strong",null,"Show MiniMap:"),o.a.createElement("input",{name:"showMiniMap",type:"checkbox",checked:n.state.showMiniMap,onChange:function(e){var t=e.target;n.setState({showMiniMap:t.checked})}})))},n.renderAnnotationToggle=function(){return o.a.createElement("div",{className:"annotation-toggle"},o.a.createElement("label",null,o.a.createElement("strong",null,"Show Annotations:"),o.a.createElement("input",{name:"showAnnotations",type:"checkbox",checked:n.state.showAnnotations,onChange:function(e){var t=e.target;n.setState({showAnnotations:t.checked})}})))},n.onFileUpload=function(e){var t;return c.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,c.a.awrap(e.text());case 2:t=r.sent,n.setState({alignment:L.fromFileContents(e.name,t)});case 4:case"end":return r.stop()}}))},n.state={style:new x,logoPlotStyle:z.LETTERS,zoomLevel:12,sortBy:y.INPUT,showMiniMap:!1,showAnnotations:!0,showSettings:!0},n}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){return c.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}},{key:"render",value:function(){var e=this.state,t=e.alignment,n=e.logoPlotStyle,r=e.showAnnotations,a=e.showMiniMap,i=e.sortBy,s=e.style,l=e.zoomLevel,c=t?o.a.createElement("div",{className:"av_holder"},o.a.createElement(ne,{alignment:t,style:s,logoPlotStyle:n,zoomLevel:l,sortBy:i,showMiniMap:a,showAnnotations:r})):o.a.createElement(o.a.Fragment,null);return o.a.createElement("div",null,this.renderSettingsBox(s),c)}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(ae,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},7:function(e,t,n){e.exports={acePrefix:"ace_",preAceQueryClass:"query",preAceConsensusClass:"consensus",aceQueryClass:"ace_query",aceConsensusClass:"ace_consensus",transparentLetterClass:"transparent-letters",transparentBackgroundClass:"transparent-background",aaAlignTypeClass:"alignment-aa",ntAlignTypeClass:"alignment-nt",styPosAllClass:"alignment-positions-tostyle-all",styPosQueryClass:"alignment-positions-tostyle-query",styPosQueryDiffClass:"alignment-positions-tostyle-query-diff",styPosConsensusClass:"alignment-positions-tostyle-consensus",styPosConsensusDiffClass:"alignment-positions-tostyle-consensus-diff",aaStyClass_Default:"aa-alignment-style-default",aaStyDesc_Default:"Default",aaStyBGAlpha_Default:".25",aaStyColorOrder_Default:"A,R,N,D,C,Q,E,G,H,I,L,K,M,F,P,S,T,W,Y,V",aaStyColors_Default:"#3c0,#c00,#60c,#03f,#ff0,#60c,#03f,#3c0,#090,#3c0,#3c0,#c00,#3c0,#090,#3c0,#09f,#09f,#090,#090,#3c0",aaStyClass_Hydrophobicity:"aa-alignment-style-hydrophobicity",aaStyDesc_Hydrophobicity:"Hydrophobicity",aaStyBGAlpha_Hydrophobicity:".25",aaStyColorOrder_Hydrophobicity:"F,I,W,L,V,M,Y,C,A,T,H,G,S,Q,R,K,N,E,P,D",aaStyColors_Hydrophobicity:"red,red,#ff0606,#ff0606,#ff4c4c,#ff5252,#f77,#ffa5a5,#ffc0c0,#e1e1ff,#d0d0ff,#b6b6ff,#a5a5ff,#9595ff,#8787ff,#6969ff,#5959ff,#4f4fff,#1d1dff,blue",ntStyClass_Default:"nt-alignment-style-default",ntStyDesc_Default:"Default",ntStyBGAlpha_Default:".25",ntStyColorOrder_Default:"A,C,G,T,U,R,Y",ntStyColors_Default:"#5050ff,#e00000,#00c000,#e6e600,#c90,#2e8b57,#ff8c00"}}},[[29,1,2]]]);
//# sourceMappingURL=main.810bff6d.chunk.js.map